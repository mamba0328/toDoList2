(()=>{"use strict";function e(){const e=document.getElementById("modalWindow"),t=document.getElementById("overlay");e.classList.remove("active"),t.classList.remove("active"),document.getElementById("notes").value="",document.getElementById("modalTaskName").value=""}const t=function(e,t="today",n="",a="",s){let o=Math.floor(1e5*Math.random());return{name:e,deadline:t,notes:n,tags:a,id:o,putTask:function(){let e=s(),t=[this.name,this.deadline,this.notes,this.tags,o];e.push(t),localStorage.setItem("task",JSON.stringify(e))}}},n=function(e,t,n){const a=document.createElement("div");a.setAttribute("id","task"),a.classList.add(n),console.log(a.classList.value);const s=document.createElement("div");s.classList.add("completeCircle");const o=document.createElement("h3");o.classList.add("taskName"),o.setAttribute("id",n),o.innerText=e,a.appendChild(s),a.appendChild(o),0==t?document.getElementById("todayHolder").appendChild(a):1==t?document.getElementById("tommorowHolder").appendChild(a):document.getElementById("somedayHolder").appendChild(a)},a=function(e,t){const n=e.target.id;let a="";for(let e=0;e<t.length;e++)n==t[e].id&&(a=t[e]);return[a.name,a.deadline,a.id]};function s(){const e=document.getElementById("modalInfo"),t=document.getElementById("overlay");e.classList.remove("active"),t.classList.remove("active");const n=document.getElementById("apply");n.classList.contains(n.classList.value)&&n.classList.remove(n.classList.value)}const o=function(e){const t=Array.from(document.querySelectorAll(".tag"));for(let n=0;n<t.length;n++)e.includes(t[n].id)?t[n].classList.add("chosen"):t[n].classList.remove("chosen")},l=function(){const e=localStorage.getItem("task");return null!==e?JSON.parse(e):[]},r=function(e,t){localStorage.clear(),e.forEach((e=>{e.putTask()}))},d=[];let c="",i=[],m=l();0!=m&&m.forEach((e=>{let a=t(e[0],e[1],e[2],e[3],l);d.push(a),n(a.name,a.deadline,a.id)}));const g=document.getElementById("addATask");g.addEventListener("mouseover",(e=>{e.target.style.backgroundColor="rgb(36, 163, 26)"})),g.addEventListener("mouseleave",(e=>{e.target.style.backgroundColor="rgb(26, 153, 26)"})),g.addEventListener("click",(()=>{!function(e,t){e([]);const n=document.getElementById("modalWindow"),a=document.getElementById("overlay");n.classList.add("active"),a.classList.add("active"),Array.from(document.getElementsByClassName("deadline")).forEach((e=>{e.style.color="rgb(78,78,78)"}))}(o)})),document.getElementById("overlay").addEventListener("click",(()=>{e(),s(),c="",i=[]}));const u=document.getElementById("modalTaskName");u.addEventListener("mouseenter",(e=>{e.target.style.outline="solid",e.target.style.outlineWidth="1px",e.target.style.outlineColor="grey"})),u.addEventListener("mouseleave",(e=>{e.target.style.outline="none"}));const y=Array.from(document.getElementsByClassName("deadline"));y.forEach((e=>{e.addEventListener("mouseover",(e=>{""===c&&(e.target.style.color="rgba(26, 153, 26)")})),e.addEventListener("mouseout",(e=>{""===c&&(e.target.style.color="rgb(78, 78, 78)")}))}));for(let e=0;e<y.length;e++)y[e].addEventListener("click",(t=>(y.forEach((e=>{e.style.color="rgb(78,78,78)"})),t.target.style.color="rgba(26, 153, 26)",c=e)));const E=document.getElementById("saveTask");E.addEventListener("click",(()=>{if(0!=u.value){const a=document.getElementById("notes");let s=t(u.value,c,a.value,i,l);s.putTask(),d.push(s),n(s.name,s.deadline,s.id),c="",i=[],e()}else alert("You should enter at least name of the task")})),E.addEventListener("mouseover",(e=>{e.target.style.backgroundColor="rgb(26, 153, 26)"})),E.addEventListener("mouseleave",(e=>{e.target.style.backgroundColor="transparent"})),Array.from(document.getElementsByClassName("todoDeadline")).forEach((e=>{e.addEventListener("mouseover",(e=>{e.target.previousElementSibling?e.target.classList.add("mouseon"):(e.target.style.borderBottom="1.5px solid grey",e.target.style.color="black")})),e.addEventListener("mouseleave",(e=>{e.target.previousElementSibling?e.target.classList.remove("mouseon"):(e.target.style.borderBottom="none",e.target.style.color="rgb(100, 100, 100)")})),e.addEventListener("click",(e=>{"none"===e.target.nextElementSibling.style.display?e.target.nextElementSibling.style.display="flex":e.target.nextElementSibling.style.display="none"}))}));const v=document.querySelector("body");v.addEventListener("click",(e=>{e.target.matches(".completeCircle")&&(function(e,t){const n=e.target.parentElement.classList.value;let a=0;for(let e=0;e<t.length;e++)n==t[e].id&&(a=t[e]);const s=document.getElementById("competedTasks"),o=document.createElement("del");o.innerText=a.name,o.classList.add("completedTask"),o.setAttribute("id",a.id),s.appendChild(o)}(e,d),e.target.parentElement.remove())})),v.addEventListener("mouseover",(e=>{e.target.matches(".completeCircle")&&(e.target.style.border="2px solid green")})),v.addEventListener("mouseout",(e=>{e.target.matches(".completeCircle")&&(e.target.style.border="1.99px solid black")})),v.addEventListener("mouseover",(e=>{e.target.matches(".completedTask")&&e.target.classList.add("mouseon")})),v.addEventListener("mouseout",(e=>{e.target.matches(".completedTask")&&e.target.classList.remove("mouseon")})),v.addEventListener("click",(e=>{e.target.matches(".completedTask")&&(n(a(e,d)[0],a(e,d)[1],a(e,d)[2]),e.target.remove())})),Array.from(document.querySelectorAll(".tag")).forEach((e=>{e.addEventListener("click",(e=>{(function(e,t){if(t.includes(e.target.innerText))for(let n=0;n<t.length;n++)t[n]==e.target.innerText&&t.splice(n,1);else t.push(e.target.innerText)})(e,i),console.log(i),o(i)}))})),v.addEventListener("click",(e=>{e.target.matches(".taskName")&&(console.log(i),i=function(e,t,n,a){const s=e.target.parentElement.classList.value;let o="";for(let e=0;e<n.length;e++)s==n[e].id&&(o=n[e]);a=o.tags,t(o.tags),document.getElementById("taskInfoName").innerText=o.name,document.getElementById("taskInfoNotes").innerText=o.notes;const l=document.getElementById("modalInfo"),r=document.getElementById("overlay");l.classList.add("active"),r.classList.add("active");const d=Array.from(document.getElementsByClassName("infoDeadline"));return d.forEach((e=>{e.style.color="rgb(78,78,78)"})),0==o.deadline&&(d[0].style.color="rgba(26, 153, 26)"),1==o.deadline&&(d[1].style.color="rgba(26, 153, 26)"),2==o.deadline&&(d[2].style.color="rgba(26, 153, 26)"),document.getElementById("apply").classList.add(s),a}(e,o,d,i),console.log(i))})),document.getElementById("apply").addEventListener("click",(e=>{(function(e,t,n,a,s,o,l){const r=e.target.classList.value;let d="";for(let e=0;e<n.length;e++)r==n[e].id&&(d=n[e]);d.tags=t,e.target.classList.remove(r),d.deadline!=a&&(d.deadline=a,document.getElementById(d.id).parentElement.remove(),s(d.name,d.deadline,d.id)),o(n,l)})(e,i,d,c,n,r,l),s()}));const L=Array.from(document.getElementsByClassName("infoDeadline"));L.forEach((e=>{e.addEventListener("click",(e=>{L.forEach((e=>{e.style.color="rgb(78,78,78)"})),c=function(e,t){return e.target.style.color="rgb(26, 153, 26)","Today"==e.target.innerText&&(t=0),"Tommorow"==e.target.innerText&&(t=1),"Someday"==e.target.innerText&&(t=2),t}(e,c)}))})),document.getElementById("cancel").addEventListener("click",(()=>{s(),c="",i=[]}));const f=Array.from(document.getElementsByClassName("navigationTag"));f.forEach((e=>{e.addEventListener("mouseover",(t=>{e.classList.add(t.target.id)})),e.addEventListener("mouseleave",(t=>{Array.from(t.target.classList.value).includes("c")||e.classList.remove(t.target.id)})),e.addEventListener("click",(t=>{Array.from(t.target.classList.value).includes("c")?(e.classList.remove(t.target.id),e.classList.remove("chosen"),Array.from(document.getElementsByClassName("taskName")).forEach((e=>{e.parentElement.style.display="flex"}))):(f.forEach((e=>{e.classList.remove(e.id),e.classList.remove("chosen")})),e.classList.add(t.target.id),e.classList.add("chosen"),function(e,t){const n=e.target.innerText,a=Array.from(document.getElementsByClassName("taskName"));let s=[];for(let e=0;e<t.length;e++)for(let a=0;a<t.length;a++)n==t[e].tags[a]&&s.push(t[e].id);a.forEach((e=>{e.parentElement.style.display="none";for(let t=0;t<a.length;t++)s[t]==e.id&&(e.parentElement.style.display="flex")}))}(t,d))}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBYUEsU0FBU0EsSUFDTCxNQUFNQyxFQUFRQyxTQUFTQyxlQUFlLGVBQ2hDQyxFQUFVRixTQUFTQyxlQUFlLFdBQ3hDRixFQUFNSSxVQUFVQyxPQUFPLFVBQ3ZCRixFQUFRQyxVQUFVQyxPQUFPLFVBQ1JKLFNBQVNDLGVBQWUsU0FDaENJLE1BQVEsR0FDSEwsU0FBU0MsZUFBZSxpQkFDaENJLE1BQVEsR0NQbEIsUUFkQSxTQUFrQkMsRUFBTUMsRUFBVyxRQUFTQyxFQUFRLEdBQUlDLEVBQU8sR0FBSUMsR0FFL0QsSUFBSUMsRUFBS0MsS0FBS0MsTUFBb0IsSUFBZEQsS0FBS0UsVUFTekIsTUFBTyxDQUFDUixLQUFBQSxFQUFNQyxTQUFBQSxFQUFVQyxNQUFBQSxFQUFPQyxLQUFBQSxFQUFNRSxHQUFBQSxFQUFJSSxRQVB6QyxXQUNJLElBQUlDLEVBQVFOLElBQ1JPLEVBQU8sQ0FBQ0MsS0FBS1osS0FBTVksS0FBS1gsU0FBVVcsS0FBS1YsTUFBT1UsS0FBS1QsS0FBTUUsR0FDN0RLLEVBQU1HLEtBQUtGLEdBQ1hHLGFBQWFDLFFBQVEsT0FBUUMsS0FBS0MsVUFBVVAsT0N3QnBELEVBaENBLFNBQWtCVixFQUFNQyxFQUFVSSxHQUM5QixNQUFNTSxFQUFPakIsU0FBU3dCLGNBQWMsT0FDcENQLEVBQUtRLGFBQWEsS0FBTSxRQUV4QlIsRUFBS2QsVUFBVXVCLElBQUlmLEdBQ25CZ0IsUUFBUUMsSUFBSVgsRUFBS2QsVUFBVUUsT0FFM0IsTUFBTXdCLEVBQWlCN0IsU0FBU3dCLGNBQWMsT0FDOUNLLEVBQWUxQixVQUFVdUIsSUFBSSxrQkFFN0IsTUFBTUksRUFBVzlCLFNBQVN3QixjQUFjLE1BQ3hDTSxFQUFTM0IsVUFBVXVCLElBQUksWUFDdkJJLEVBQVNMLGFBQWEsS0FBTWQsR0FDNUJtQixFQUFTQyxVQUFZekIsRUFFckJXLEVBQUtlLFlBQVlILEdBQ2pCWixFQUFLZSxZQUFZRixHQUlGLEdBQVp2QixFQUNxQlAsU0FBU0MsZUFBZSxlQUNoQytCLFlBQVlmLEdBQ0wsR0FBWlYsRUFDZ0JQLFNBQVNDLGVBQWUsa0JBQ2hDK0IsWUFBWWYsR0FFTGpCLFNBQVNDLGVBQWUsaUJBQ2hDK0IsWUFBWWYsSUNkbEMsRUFkQSxTQUE2QmdCLEVBQUdDLEdBRTVCLE1BQU1DLEVBQVNGLEVBQUVHLE9BQU96QixHQUN4QixJQUFJTSxFQUFPLEdBRVgsSUFBSSxJQUFJb0IsRUFBRSxFQUFHQSxFQUFFSCxFQUFnQkksT0FBUUQsSUFDaENGLEdBQVVELEVBQWdCRyxHQUFHMUIsS0FDNUJNLEVBQU9pQixFQUFnQkcsSUFJL0IsTUFEbUIsQ0FBQ3BCLEVBQUtYLEtBQU1XLEVBQUtWLFNBQVVVLEVBQUtOLEtDd0N2RCxTQUFTNEIsSUFDTCxNQUFNQyxFQUFZeEMsU0FBU0MsZUFBZSxhQUNwQ0MsRUFBVUYsU0FBU0MsZUFBZSxXQUN4Q3VDLEVBQVVyQyxVQUFVQyxPQUFPLFVBQzNCRixFQUFRQyxVQUFVQyxPQUFPLFVBRXpCLE1BQU1xQyxFQUFjekMsU0FBU0MsZUFBZSxTQUV6Q3dDLEVBQVl0QyxVQUFVdUMsU0FBU0QsRUFBWXRDLFVBQVVFLFFBQ3hEb0MsRUFBWXRDLFVBQVVDLE9BQU9xQyxFQUFZdEMsVUFBVUUsT0NoRHZELFFBWEEsU0FBcUJzQyxHQUNqQixNQUFNbEMsRUFBT21DLE1BQU1DLEtBQUs3QyxTQUFTOEMsaUJBQWlCLFNBQ2xELElBQUksSUFBSVQsRUFBRSxFQUFHQSxFQUFFNUIsRUFBSzZCLE9BQVFELElBQ3BCTSxFQUFXSSxTQUFTdEMsRUFBSzRCLEdBQUcxQixJQUMzQkYsRUFBSzRCLEdBQUdsQyxVQUFVdUIsSUFBSSxVQUV2QmpCLEVBQUs0QixHQUFHbEMsVUFBVUMsT0FBTyxXQ0VwQyxFQVJhLFdBQ1YsTUFBTTRDLEVBQW9CNUIsYUFBYTZCLFFBQVEsUUFDOUMsT0FBeUIsT0FBdEJELEVBQ00xQixLQUFLNEIsTUFBTUYsR0FFaEIsSUNFVCxFQVBBLFNBQTBCZCxFQUFpQnhCLEdBQzNDVSxhQUFhK0IsUUFDYmpCLEVBQWdCa0IsU0FBUW5DLElBQ3BCQSxFQUFLRixjQ1dIbUIsRUFBa0IsR0FDeEIsSUFBSW1CLEVBQWlCLEdBQ2pCVixFQUFhLEdBR2JXLEVBQWdCLElBQ0MsR0FBakJBLEdBQ0FBLEVBQWNGLFNBQVFuQyxJQUN0QixJQUFJc0MsRUFBVSxFQUFTdEMsRUFBSyxHQUFJQSxFQUFLLEdBQUlBLEVBQUssR0FBSUEsRUFBSyxHQUFJLEdBQzNEaUIsRUFBZ0JmLEtBQUtvQyxHQUNyQixFQUFTQSxFQUFRakQsS0FBTWlELEVBQVFoRCxTQUFVZ0QsRUFBUTVDLE9BS3JELE1BQU02QyxFQUFpQnhELFNBQVNDLGVBQWUsWUFFL0N1RCxFQUFlQyxpQkFBaUIsYUFBY3hCLElBQzFDQSxFQUFFRyxPQUFPc0IsTUFBTUMsZ0JBQWtCLHNCQUVyQ0gsRUFBZUMsaUJBQWlCLGNBQWV4QixJQUMzQ0EsRUFBRUcsT0FBT3NCLE1BQU1DLGdCQUFrQixzQkFFckNILEVBQWVDLGlCQUFpQixTQUFTLE1SckN6QyxTQUFtQkcsRUFBYWpCLEdBRTVCaUIsRUFEYSxJQUViLE1BQU03RCxFQUFRQyxTQUFTQyxlQUFlLGVBQ2hDQyxFQUFVRixTQUFTQyxlQUFlLFdBQ3hDRixFQUFNSSxVQUFVdUIsSUFBSSxVQUNwQnhCLEVBQVFDLFVBQVV1QixJQUFJLFVBQ0prQixNQUFNQyxLQUFLN0MsU0FBUzZELHVCQUF1QixhQUNuRFQsU0FBUTdDLElBQ2RBLEVBQVNtRCxNQUFNSSxNQUFRLG1CUTZCM0JDLENBQVUsTUFJRS9ELFNBQVNDLGVBQWUsV0FFaEN3RCxpQkFBaUIsU0FBUyxLQUM5QjNELElBQ0F5QyxJQUNBYyxFQUFpQixHQUNqQlYsRUFBYSxNQUlqQixNQUFNcUIsRUFBZ0JoRSxTQUFTQyxlQUFlLGlCQUU5QytELEVBQWNQLGlCQUFpQixjQUFleEIsSUFDMUNBLEVBQUVHLE9BQU9zQixNQUFNTyxRQUFVLFFBQ3pCaEMsRUFBRUcsT0FBT3NCLE1BQU1RLGFBQWUsTUFDOUJqQyxFQUFFRyxPQUFPc0IsTUFBTVMsYUFBZSxVQUdsQ0gsRUFBY1AsaUJBQWlCLGNBQWV4QixJQUMxQ0EsRUFBRUcsT0FBT3NCLE1BQU1PLFFBQVUsVUFJN0IsTUFBTUcsRUFBWXhCLE1BQU1DLEtBQUs3QyxTQUFTNkQsdUJBQXVCLGFBRTdETyxFQUFVaEIsU0FBUTdDLElBQ2RBLEVBQVNrRCxpQkFBaUIsYUFBY3hCLElBQ2QsS0FBbkJvQixJQUNDcEIsRUFBRUcsT0FBT3NCLE1BQU1JLE1BQVEsd0JBRy9CdkQsRUFBU2tELGlCQUFpQixZQUFheEIsSUFDYixLQUFuQm9CLElBQ0NwQixFQUFFRyxPQUFPc0IsTUFBTUksTUFBUSx5QkFLL0IsSUFBSSxJQUFJekIsRUFBRSxFQUFHQSxFQUFFK0IsRUFBVTlCLE9BQVFELElBRWhDK0IsRUFBVS9CLEdBQUdvQixpQkFBaUIsU0FBVXhCLElBQ2pDbUMsRUFBVWhCLFNBQVE3QyxJQUNqQkEsRUFBU21ELE1BQU1JLE1BQVEsbUJBRXhCN0IsRUFBRUcsT0FBT3NCLE1BQU1JLE1BQVEsb0JBQ2hCVCxFQUFpQmhCLEtBS3BDLE1BQU1nQyxFQUFXckUsU0FBU0MsZUFBZSxZQUV6Q29FLEVBQVNaLGlCQUFpQixTQUFTLEtBQy9CLEdBQTBCLEdBQXZCTyxFQUFjM0QsTUFBVyxDQUU1QixNQUFNaUUsRUFBWXRFLFNBQVNDLGVBQWUsU0FDMUMsSUFBSXNELEVBQVUsRUFBU1MsRUFBYzNELE1BQU9nRCxFQUFnQmlCLEVBQVVqRSxNQUFPc0MsRUFBWSxHQUN6RlksRUFBUXhDLFVBQ1JtQixFQUFnQmYsS0FBS29DLEdBQ3JCLEVBQVNBLEVBQVFqRCxLQUFNaUQsRUFBUWhELFNBQVVnRCxFQUFRNUMsSUFFakQwQyxFQUFpQixHQUNqQlYsRUFBYSxHQUNiN0MsU0FFR3lFLE1BQU0saURBSWJGLEVBQVNaLGlCQUFpQixhQUFjeEIsSUFDcENBLEVBQUVHLE9BQU9zQixNQUFNQyxnQkFBa0Isc0JBR3JDVSxFQUFTWixpQkFBaUIsY0FBZXhCLElBQ3JDQSxFQUFFRyxPQUFPc0IsTUFBTUMsZ0JBQWtCLGlCQUlmZixNQUFNQyxLQUFLN0MsU0FBUzZELHVCQUF1QixpQkFDbkRULFNBQVFvQixJQUNsQkEsRUFBYWYsaUJBQWlCLGFBQWN4QixJQUNwQ0EsRUFBRUcsT0FBT3FDLHVCQUlieEMsRUFBRUcsT0FBT2pDLFVBQVV1QixJQUFJLFlBSG5CTyxFQUFFRyxPQUFPc0IsTUFBTWdCLGFBQWUsbUJBQzlCekMsRUFBRUcsT0FBT3NCLE1BQU1JLE1BQVEsWUFNL0JVLEVBQWFmLGlCQUFpQixjQUFleEIsSUFDckNBLEVBQUVHLE9BQU9xQyx1QkFJYnhDLEVBQUVHLE9BQU9qQyxVQUFVQyxPQUFPLFlBSHRCNkIsRUFBRUcsT0FBT3NCLE1BQU1nQixhQUFlLE9BQzlCekMsRUFBRUcsT0FBT3NCLE1BQU1JLE1BQVEseUJBTS9CVSxFQUFhZixpQkFBaUIsU0FBVXhCLElBQ2EsU0FBOUNBLEVBQUVHLE9BQU91QyxtQkFBbUJqQixNQUFNa0IsUUFDakMzQyxFQUFFRyxPQUFPdUMsbUJBQW1CakIsTUFBTWtCLFFBQVUsT0FFNUMzQyxFQUFFRyxPQUFPdUMsbUJBQW1CakIsTUFBTWtCLFFBQVUsYUFPeEQsTUFBTUMsRUFBTzdFLFNBQVM4RSxjQUFjLFFBQ3BDRCxFQUFLcEIsaUJBQWlCLFNBQVV4QixJQUN6QkEsRUFBRUcsT0FBTzJDLFFBQVEscUJDekp4QixTQUFzQjlDLEVBQUdDLEdBQ3JCLE1BQU1DLEVBQVNGLEVBQUVHLE9BQU80QyxjQUFjN0UsVUFBVUUsTUFDaEQsSUFBSVksRUFBTyxFQUVYLElBQUksSUFBSW9CLEVBQUUsRUFBR0EsRUFBRUgsRUFBZ0JJLE9BQVFELElBQ2hDRixHQUFVRCxFQUFnQkcsR0FBRzFCLEtBQzVCTSxFQUFPaUIsRUFBZ0JHLElBSS9CLE1BQU00QyxFQUF1QmpGLFNBQVNDLGVBQWUsaUJBQy9DaUYsRUFBZ0JsRixTQUFTd0IsY0FBYyxPQUM3QzBELEVBQWNuRCxVQUFZZCxFQUFLWCxLQUUvQjRFLEVBQWMvRSxVQUFVdUIsSUFBSSxpQkFDNUJ3RCxFQUFjekQsYUFBYSxLQUFNUixFQUFLTixJQUN0Q3NFLEVBQXFCakQsWUFBWWtELEdEMEk5QixDQUFhakQsRUFBR0MsR0FDaEJELEVBQUVHLE9BQU80QyxjQUFjNUUsYUFJOUJ5RSxFQUFLcEIsaUJBQWlCLGFBQWN4QixJQUM3QkEsRUFBRUcsT0FBTzJDLFFBQVEscUJBQ2hCOUMsRUFBRUcsT0FBT3NCLE1BQU15QixPQUFTLHNCQUloQ04sRUFBS3BCLGlCQUFpQixZQUFheEIsSUFDNUJBLEVBQUVHLE9BQU8yQyxRQUFRLHFCQUNoQjlDLEVBQUVHLE9BQU9zQixNQUFNeUIsT0FBUyx5QkFNaENOLEVBQUtwQixpQkFBaUIsYUFBY3hCLElBQzdCQSxFQUFFRyxPQUFPMkMsUUFBUSxtQkFDakI5QyxFQUFFRyxPQUFPakMsVUFBVXVCLElBQUksY0FJOUJtRCxFQUFLcEIsaUJBQWlCLFlBQWF4QixJQUM1QkEsRUFBRUcsT0FBTzJDLFFBQVEsbUJBQ2pCOUMsRUFBRUcsT0FBT2pDLFVBQVVDLE9BQU8sY0FJakN5RSxFQUFLcEIsaUJBQWlCLFNBQVV4QixJQUN6QkEsRUFBRUcsT0FBTzJDLFFBQVEsb0JBQ2hCLEVBQVMsRUFBb0I5QyxFQUFHQyxHQUFpQixHQUFHLEVBQW9CRCxFQUFHQyxHQUFpQixHQUFHLEVBQW9CRCxFQUFHQyxHQUFpQixJQUN2SUQsRUFBRUcsT0FBT2hDLGFBS0p3QyxNQUFNQyxLQUFLN0MsU0FBUzhDLGlCQUFpQixTQUM3Q00sU0FBUWdDLElBQ1RBLEVBQUkzQixpQkFBaUIsU0FBVXhCLEtFbk1uQyxTQUFrQkEsRUFBR1UsR0FFakIsR0FBR0EsRUFBV0ksU0FBU2QsRUFBRUcsT0FBT0wsV0FDNUIsSUFBSSxJQUFJTSxFQUFFLEVBQUdBLEVBQUVNLEVBQVdMLE9BQVFELElBQzVCTSxFQUFXTixJQUFNSixFQUFFRyxPQUFPTCxXQUN6QlksRUFBVzBDLE9BQU9oRCxFQUFHLFFBSTVCTSxFQUFXeEIsS0FBS2MsRUFBRUcsT0FBT0wsWUYyTHpCLENBQVNFLEVBQUdVLEdBQ1poQixRQUFRQyxJQUFJZSxHQUNaLEVBQVlBLFNBS25Ca0MsRUFBS3BCLGlCQUFpQixTQUFVeEIsSUFDekJBLEVBQUVHLE9BQU8yQyxRQUFRLGVBQ2hCcEQsUUFBUUMsSUFBSWUsR0FDWkEsRUo5TVQsU0FBdUJWLEVBQUcyQixFQUFhMUIsRUFBaUJTLEdBRXBELE1BQU1SLEVBQVNGLEVBQUVHLE9BQU80QyxjQUFjN0UsVUFBVUUsTUFDaEQsSUFBSVksRUFBTyxHQUVYLElBQUksSUFBSW9CLEVBQUUsRUFBR0EsRUFBRUgsRUFBZ0JJLE9BQVFELElBQ2hDRixHQUFVRCxFQUFnQkcsR0FBRzFCLEtBQzVCTSxFQUFPaUIsRUFBZ0JHLElBSS9CTSxFQUFhMUIsRUFBS1IsS0FDbEJtRCxFQUFZM0MsRUFBS1IsTUFHQVQsU0FBU0MsZUFBZSxnQkFDaEM4QixVQUFZZCxFQUFLWCxLQUdSTixTQUFTQyxlQUFlLGlCQUNoQzhCLFVBQVlkLEVBQUtULE1BRTNCLE1BQU1nQyxFQUFZeEMsU0FBU0MsZUFBZSxhQUNwQ0MsRUFBVUYsU0FBU0MsZUFBZSxXQUN4Q3VDLEVBQVVyQyxVQUFVdUIsSUFBSSxVQUN4QnhCLEVBQVFDLFVBQVV1QixJQUFJLFVBR3RCLE1BQU00RCxFQUFnQjFDLE1BQU1DLEtBQUs3QyxTQUFTNkQsdUJBQXVCLGlCQW1CakUsT0FqQkF5QixFQUFjbEMsU0FBUW1DLElBQ2xCQSxFQUFRN0IsTUFBTUksTUFBUSxtQkFHTixHQUFqQjdDLEVBQUtWLFdBQ0orRSxFQUFjLEdBQUc1QixNQUFNSSxNQUFRLHFCQUVmLEdBQWpCN0MsRUFBS1YsV0FDSitFLEVBQWMsR0FBRzVCLE1BQU1JLE1BQVEscUJBRWYsR0FBakI3QyxFQUFLVixXQUNKK0UsRUFBYyxHQUFHNUIsTUFBTUksTUFBUSxxQkFHZjlELFNBQVNDLGVBQWUsU0FDaENFLFVBQVV1QixJQUFJUyxHQUVuQlEsRUkrSlc2QyxDQUFjdkQsRUFBRyxFQUFhQyxFQUFpQlMsR0FDNURoQixRQUFRQyxJQUFJZSxPQUtEM0MsU0FBU0MsZUFBZSxTQUNoQ3dELGlCQUFpQixTQUFVeEIsS0dyTnZDLFNBQXNCQSxFQUFHVSxFQUFZVCxFQUFpQm1CLEVBQWdCb0MsRUFBV0MsRUFBaUJoRixHQUc5RixNQUFNeUIsRUFBU0YsRUFBRUcsT0FBT2pDLFVBQVVFLE1BQ2xDLElBQUlZLEVBQU8sR0FFWCxJQUFJLElBQUlvQixFQUFFLEVBQUdBLEVBQUVILEVBQWdCSSxPQUFRRCxJQUNoQ0YsR0FBVUQsRUFBZ0JHLEdBQUcxQixLQUM1Qk0sRUFBT2lCLEVBQWdCRyxJQUkvQnBCLEVBQUtSLEtBQU9rQyxFQUNaVixFQUFFRyxPQUFPakMsVUFBVUMsT0FBTytCLEdBR3ZCbEIsRUFBS1YsVUFBWThDLElBQ2hCcEMsRUFBS1YsU0FBVzhDLEVBQ0ZyRCxTQUFTQyxlQUFlZ0IsRUFBS04sSUFDbkNxRSxjQUFjNUUsU0FDdEJxRixFQUFTeEUsRUFBS1gsS0FBTVcsRUFBS1YsU0FBVVUsRUFBS04sS0FHNUMrRSxFQUFnQnhELEVBQWlCeEIsSUgrTGpDLENBQWF1QixFQUFHVSxFQUFZVCxFQUFpQm1CLEVBQWdCLEVBQVUsRUFBaUIsR0FDeEZkLE9BSUosTUFBTW9ELEVBQWUvQyxNQUFNQyxLQUFLN0MsU0FBUzZELHVCQUF1QixpQkFFaEU4QixFQUFhdkMsU0FBU3dDLElBQ2xCQSxFQUFPbkMsaUJBQWlCLFNBQVV4QixJQUM5QjBELEVBQWF2QyxTQUFReUMsSUFDakJBLEVBQUluQyxNQUFNSSxNQUFRLG1CQUd0QlQsRUluT1IsU0FBd0JwQixFQUFHb0IsR0FldkIsT0FiQXBCLEVBQUVHLE9BQU9zQixNQUFNSSxNQUFRLG1CQUVFLFNBQXRCN0IsRUFBRUcsT0FBT0wsWUFDUnNCLEVBQWlCLEdBRUksWUFBdEJwQixFQUFFRyxPQUFPTCxZQUNSc0IsRUFBaUIsR0FFSSxXQUF0QnBCLEVBQUVHLE9BQU9MLFlBQ1JzQixFQUFpQixHQUlkQSxFSm9OYyxDQUFlcEIsRUFBR29CLFNBS3RCckQsU0FBU0MsZUFBZSxVQUNoQ3dELGlCQUFpQixTQUFTLEtBQ25DbEIsSUFDQWMsRUFBaUIsR0FDakJWLEVBQWEsTUFJakIsTUFBTW1ELEVBQWlCbEQsTUFBTUMsS0FBSzdDLFNBQVM2RCx1QkFBdUIsa0JBQ2xFaUMsRUFBZTFDLFNBQVFnQyxJQUVuQkEsRUFBSTNCLGlCQUFpQixhQUFjeEIsSUFDL0JtRCxFQUFJakYsVUFBVXVCLElBQUlPLEVBQUVHLE9BQU96QixPQUcvQnlFLEVBQUkzQixpQkFBaUIsY0FBZXhCLElBQzVCVyxNQUFNQyxLQUFLWixFQUFFRyxPQUFPakMsVUFBVUUsT0FBTzBDLFNBQVMsTUFDOUNxQyxFQUFJakYsVUFBVUMsT0FBTzZCLEVBQUVHLE9BQU96QixPQUt0Q3lFLEVBQUkzQixpQkFBaUIsU0FBVXhCLElBRXhCVyxNQUFNQyxLQUFLWixFQUFFRyxPQUFPakMsVUFBVUUsT0FBTzBDLFNBQVMsTUFDN0NxQyxFQUFJakYsVUFBVUMsT0FBTzZCLEVBQUVHLE9BQU96QixJQUM5QnlFLEVBQUlqRixVQUFVQyxPQUFPLFVLMU9md0MsTUFBTUMsS0FBSzdDLFNBQVM2RCx1QkFBdUIsYUFDbkRULFNBQVFuQyxJQUNOQSxFQUFLK0QsY0FBY3RCLE1BQU1rQixRQUFVLFlMNE9uQ2tCLEVBQWUxQyxTQUFRbUMsSUFDbkJBLEVBQVFwRixVQUFVQyxPQUFPbUYsRUFBUTVFLElBQ2pDNEUsRUFBUXBGLFVBQVVDLE9BQU8sYUFHN0JnRixFQUFJakYsVUFBVXVCLElBQUlPLEVBQUVHLE9BQU96QixJQUMzQnlFLEVBQUlqRixVQUFVdUIsSUFBSSxVSzVROUIsU0FBd0JPLEVBQUdDLEdBQ3ZCLE1BQU02RCxFQUFZOUQsRUFBRUcsT0FBT0wsVUFDckJmLEVBQVE0QixNQUFNQyxLQUFLN0MsU0FBUzZELHVCQUF1QixhQUN6RCxJQUFJbUMsRUFBZSxHQUVuQixJQUFJLElBQUkzRCxFQUFFLEVBQUdBLEVBQUVILEVBQWdCSSxPQUFRRCxJQUNuQyxJQUFJLElBQUk0RCxFQUFFLEVBQUdBLEVBQUUvRCxFQUFnQkksT0FBUTJELElBQ2hDRixHQUFhN0QsRUFBZ0JHLEdBQUc1QixLQUFLd0YsSUFDcENELEVBQWE3RSxLQUFLZSxFQUFnQkcsR0FBRzFCLElBS2pESyxFQUFNb0MsU0FBUW5DLElBQ1ZBLEVBQUsrRCxjQUFjdEIsTUFBTWtCLFFBQVUsT0FDbkMsSUFBSSxJQUFJdkMsRUFBRSxFQUFHQSxFQUFFckIsRUFBTXNCLE9BQVFELElBQ3RCMkQsRUFBYTNELElBQU1wQixFQUFLTixLQUN2Qk0sRUFBSytELGNBQWN0QixNQUFNa0IsUUFBVSxXTDRQdkNzQixDQUFlakUsRUFBR0MsVyIsInNvdXJjZXMiOlsid2VicGFjazovL3RvZG9saXN0Mi8uL3NyYy9tb2RhbEFwcGVhcmVuY2UuanMiLCJ3ZWJwYWNrOi8vdG9kb2xpc3QyLy4vc3JjL3Rhc2tGYWN0b3J5LmpzIiwid2VicGFjazovL3RvZG9saXN0Mi8uL3NyYy9zaG93VGFzay5qcyIsIndlYnBhY2s6Ly90b2RvbGlzdDIvLi9zcmMvcmV0dXJuRnJvbURlbGV0ZWQuanMiLCJ3ZWJwYWNrOi8vdG9kb2xpc3QyLy4vc3JjL21vZGFsSW5mb0FwcGVhcmVuY2UuanMiLCJ3ZWJwYWNrOi8vdG9kb2xpc3QyLy4vc3JjL2xpZ2h0VGhlQ2hvc2VuVGFnLmpzIiwid2VicGFjazovL3RvZG9saXN0Mi8uL3NyYy9nZXRUYXNrc0Zyb21TdG9yYWdlLmpzIiwid2VicGFjazovL3RvZG9saXN0Mi8uL3NyYy9yZW1vdmVGcm9tU3RvcmFnZS5qcyIsIndlYnBhY2s6Ly90b2RvbGlzdDIvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdG9kb2xpc3QyLy4vc3JjL3RyYW5zZmVyVG9EZWxldGVkLmpzIiwid2VicGFjazovL3RvZG9saXN0Mi8uL3NyYy9jaG9zZVRhZy5qcyIsIndlYnBhY2s6Ly90b2RvbGlzdDIvLi9zcmMvYXBwbHlDaGFuZ2VzLmpzIiwid2VicGFjazovL3RvZG9saXN0Mi8uL3NyYy9jaGFuZ2VEZWFkbGluZS5qcyIsIndlYnBhY2s6Ly90b2RvbGlzdDIvLi9zcmMvc2hvd1RhZ2VkVGFza3MuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gb3Blbk1vZGFsKGxpZ2h0VGhlVGFnLCBjaG9zZW5UYWdzKSB7IFxyXG4gICAgY2hvc2VuVGFncyA9IFtdO1xyXG4gICAgbGlnaHRUaGVUYWcoY2hvc2VuVGFncyk7XHJcbiAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbFdpbmRvdycpO1xyXG4gICAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdmVybGF5JylcclxuICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgIGNvbnN0IGRlYWRsaW5lcyA9IEFycmF5LmZyb20oZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZGVhZGxpbmUnKSk7XHJcbiAgICBkZWFkbGluZXMuZm9yRWFjaChkZWFkbGluZSA9PiB7IFxyXG4gICAgICAgIGRlYWRsaW5lLnN0eWxlLmNvbG9yID0gJ3JnYig3OCw3OCw3OCknXHJcbiAgICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsKCkgeyBcclxuICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsV2luZG93Jyk7XHJcbiAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXknKTtcclxuICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgIGNvbnN0IHRleHRBcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vdGVzJyk7XHJcbiAgICB0ZXh0QXJlYS52YWx1ZSA9ICcnO1xyXG4gICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxUYXNrTmFtZScpO1xyXG4gICAgaW5wdXQudmFsdWUgPSAnJztcclxufVxyXG5cclxuZXhwb3J0IHtvcGVuTW9kYWwsIFxyXG5jbG9zZU1vZGFsfSAiLCJmdW5jdGlvbiBtYWtlVGFzayhuYW1lLCBkZWFkbGluZSA9ICd0b2RheScsIG5vdGVzID0gJycsIHRhZ3MgPSAnJywgZ2V0VGFzayl7IFxyXG5cclxuICAgIGxldCBpZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSoxMDAwMDApOyAvL25lZWRlZCB0byBpZGVudGlmeSB0YXNrIFxyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBwdXRUYXNrKCl7IFxyXG4gICAgICAgIGxldCB0YXNrcyA9IGdldFRhc2soKTtcclxuICAgICAgICBsZXQgdGFzayA9IFt0aGlzLm5hbWUsIHRoaXMuZGVhZGxpbmUsIHRoaXMubm90ZXMsIHRoaXMudGFncywgaWRdO1xyXG4gICAgICAgIHRhc2tzLnB1c2godGFzayk7XHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Rhc2snLCBKU09OLnN0cmluZ2lmeSh0YXNrcykpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7bmFtZSwgZGVhZGxpbmUsIG5vdGVzLCB0YWdzLCBpZCwgcHV0VGFza31cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgbWFrZVRhc2s7IiwiZnVuY3Rpb24gc2hvd1Rhc2sobmFtZSwgZGVhZGxpbmUsIGlkKSB7IFxyXG4gICAgY29uc3QgdGFzayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgdGFzay5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3Rhc2snKTtcclxuXHJcbiAgICB0YXNrLmNsYXNzTGlzdC5hZGQoaWQpO1xyXG4gICAgY29uc29sZS5sb2codGFzay5jbGFzc0xpc3QudmFsdWUpO1xyXG5cclxuICAgIGNvbnN0IGNvbXBsZXRlQ2lyY2xlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb21wbGV0ZUNpcmNsZS5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZUNpcmNsZScpO1xyXG5cclxuICAgIGNvbnN0IHRhc2tOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuICAgIHRhc2tOYW1lLmNsYXNzTGlzdC5hZGQoJ3Rhc2tOYW1lJylcclxuICAgIHRhc2tOYW1lLnNldEF0dHJpYnV0ZSgnaWQnLCBpZCk7XHJcbiAgICB0YXNrTmFtZS5pbm5lclRleHQgPSBuYW1lO1xyXG5cclxuICAgIHRhc2suYXBwZW5kQ2hpbGQoY29tcGxldGVDaXJjbGUpO1xyXG4gICAgdGFzay5hcHBlbmRDaGlsZCh0YXNrTmFtZSk7XHJcblxyXG4gICAgLy9jaGVrcyBpbiB3aGljaCB0YXNrWm9uZSBpdCB3aWxsIGJlIHNlbnQgXHJcblxyXG4gICAgaWYoZGVhZGxpbmUgPT0gMCl7IFxyXG4gICAgICAgIGNvbnN0IHRvZGF5SG9sZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZGF5SG9sZGVyJyk7IFxyXG4gICAgICAgIHRvZGF5SG9sZGVyLmFwcGVuZENoaWxkKHRhc2spO1xyXG4gICAgfSBlbHNlIGlmKCBkZWFkbGluZSA9PSAxKSB7IFxyXG4gICAgICAgIGNvbnN0IHRvbW1vcm93SG9sZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvbW1vcm93SG9sZGVyJyk7IFxyXG4gICAgICAgIHRvbW1vcm93SG9sZGVyLmFwcGVuZENoaWxkKHRhc2spO1xyXG4gICAgfSBlbHNlIHsgXHJcbiAgICAgICAgY29uc3Qgc29tZWRheUhvbGRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb21lZGF5SG9sZGVyJyk7XHJcbiAgICAgICAgc29tZWRheUhvbGRlci5hcHBlbmRDaGlsZCh0YXNrKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgc2hvd1Rhc2s7ICIsImZ1bmN0aW9uIHJldHVybkZyb21Db21wbGV0ZWQoZSwgdGFza3NDb2xsZWN0aW9uKSB7IFxyXG5cclxuICAgIGNvbnN0IHRhc2tJZCA9IGUudGFyZ2V0LmlkO1xyXG4gICAgbGV0IHRhc2sgPSAnJztcclxuXHJcbiAgICBmb3IobGV0IGk9MDsgaTx0YXNrc0NvbGxlY3Rpb24ubGVuZ3RoOyBpKyspeyBcclxuICAgICAgICBpZih0YXNrSWQgPT0gdGFza3NDb2xsZWN0aW9uW2ldLmlkKSB7IFxyXG4gICAgICAgICAgICB0YXNrID0gdGFza3NDb2xsZWN0aW9uW2ldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnN0IHByb3BlcnRpZXMgPSBbdGFzay5uYW1lLCB0YXNrLmRlYWRsaW5lLCB0YXNrLmlkXTtcclxuICAgIHJldHVybiBwcm9wZXJ0aWVzXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IHJldHVybkZyb21Db21wbGV0ZWQ7IiwiZnVuY3Rpb24gb3Blbk1vZGFsSW5mbyhlLCBsaWdodFRoZVRhZywgdGFza3NDb2xsZWN0aW9uLCBjaG9zZW5UYWdzKSB7XHJcbiAgICAvL3Nob3dzIHdoaWNoIHRhZ3MgdGhlIHRhc2sgaGFzXHJcbiAgICBjb25zdCB0YXNrSWQgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC52YWx1ZTtcclxuICAgIGxldCB0YXNrID0gJyc7XHJcbiAgICBcclxuICAgIGZvcihsZXQgaT0wOyBpPHRhc2tzQ29sbGVjdGlvbi5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgaWYodGFza0lkID09IHRhc2tzQ29sbGVjdGlvbltpXS5pZCl7IFxyXG4gICAgICAgICAgICB0YXNrID0gdGFza3NDb2xsZWN0aW9uW2ldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjaG9zZW5UYWdzID0gdGFzay50YWdzXHJcbiAgICBsaWdodFRoZVRhZyh0YXNrLnRhZ3MpXHJcblxyXG4gICAgLy9jaGFuZ2VzIG5hbWUgdG8gdGFza3MgXHJcbiAgICBjb25zdCB0YXNrTmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrSW5mb05hbWUnKVxyXG4gICAgdGFza05hbWUuaW5uZXJUZXh0ID0gdGFzay5uYW1lXHJcblxyXG4gICAgLy9jaGFuZ2VzIG5vdGVzIHRvIHRhc2tzXHJcbiAgICBjb25zdCB0YXNrTm90ZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFza0luZm9Ob3RlcycpXHJcbiAgICB0YXNrTm90ZXMuaW5uZXJUZXh0ID0gdGFzay5ub3Rlc1xyXG5cclxuICAgIGNvbnN0IG1vZGFsSW5mbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbEluZm8nKTtcclxuICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheScpO1xyXG4gICAgbW9kYWxJbmZvLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuXHJcbiAgICAvL2NoYW5nZXMgZGVhZGxpbmUgXHJcbiAgICBjb25zdCBpbmZvRGVhZGxpbmVzID0gQXJyYXkuZnJvbShkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdpbmZvRGVhZGxpbmUnKSk7XHJcblxyXG4gICAgaW5mb0RlYWRsaW5lcy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgIGVsZW1lbnQuc3R5bGUuY29sb3IgPSAncmdiKDc4LDc4LDc4KSdcclxuICAgIH0pO1xyXG5cclxuICAgIGlmKHRhc2suZGVhZGxpbmUgPT0gMCl7IFxyXG4gICAgICAgIGluZm9EZWFkbGluZXNbMF0uc3R5bGUuY29sb3IgPSAncmdiYSgyNiwgMTUzLCAyNiknXHJcbiAgICB9XHJcbiAgICBpZih0YXNrLmRlYWRsaW5lID09IDEpeyBcclxuICAgICAgICBpbmZvRGVhZGxpbmVzWzFdLnN0eWxlLmNvbG9yID0gJ3JnYmEoMjYsIDE1MywgMjYpJ1xyXG4gICAgfVxyXG4gICAgaWYodGFzay5kZWFkbGluZSA9PSAyKXsgXHJcbiAgICAgICAgaW5mb0RlYWRsaW5lc1syXS5zdHlsZS5jb2xvciA9ICdyZ2JhKDI2LCAxNTMsIDI2KSdcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBhcHBseUJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseScpXHJcbiAgICBhcHBseUJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRhc2tJZCkgLy9oZWxwcyBpbiBmdXJ0aGVyIGlkZW50aWRpY2F0aW9uXHJcbiAgICBcclxuICAgIHJldHVybiBjaG9zZW5UYWdzXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWxJbmZvKCkgeyBcclxuICAgIGNvbnN0IG1vZGFsSW5mbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbEluZm8nKTtcclxuICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheScpO1xyXG4gICAgbW9kYWxJbmZvLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuXHJcbiAgICBjb25zdCBhcHBseUJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseScpXHJcbiAgICBcclxuICAgIGlmKGFwcGx5QnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyhhcHBseUJ1dHRvbi5jbGFzc0xpc3QudmFsdWUpKXtcclxuICAgIGFwcGx5QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoYXBwbHlCdXR0b24uY2xhc3NMaXN0LnZhbHVlKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHtvcGVuTW9kYWxJbmZvLGNsb3NlTW9kYWxJbmZvfSIsImZ1bmN0aW9uIGxpZ2h0VGhlVGFnKGNob3NlblRhZ3MpIHsgXHJcbiAgICBjb25zdCB0YWdzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFnJykpO1xyXG4gICAgZm9yKGxldCBpPTA7IGk8dGFncy5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgIGlmKGNob3NlblRhZ3MuaW5jbHVkZXModGFnc1tpXS5pZCkpe1xyXG4gICAgICAgICAgICAgdGFnc1tpXS5jbGFzc0xpc3QuYWRkKCdjaG9zZW4nKTtcclxuICAgICAgICAgfSBlbHNlIHsgXHJcbiAgICAgICAgICAgIHRhZ3NbaV0uY2xhc3NMaXN0LnJlbW92ZSgnY2hvc2VuJyk7XHJcbiAgICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgbGlnaHRUaGVUYWciLCJsZXQgZ2V0VGFzayA9IGZ1bmN0aW9uKCl7IFxyXG4gICAgY29uc3QgdGFza3NMb2NhbFN0b3JhZ2UgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndGFzaycpXHJcbiAgICAgaWYodGFza3NMb2NhbFN0b3JhZ2UgIT09IG51bGwpe1xyXG4gICAgICAgcmV0dXJuIEpTT04ucGFyc2UodGFza3NMb2NhbFN0b3JhZ2UpO1xyXG4gICAgIH1cclxuICByZXR1cm4gW11cclxuIH07XHJcblxyXG4gZXhwb3J0IGRlZmF1bHQgZ2V0VGFzayIsImZ1bmN0aW9uIHJlZnJlc2hTdG9yYWdlZCAodGFza3NDb2xsZWN0aW9uLCBnZXRUYXNrKXsgXHJcbmxvY2FsU3RvcmFnZS5jbGVhcigpXHJcbnRhc2tzQ29sbGVjdGlvbi5mb3JFYWNoKHRhc2sgPT4geyBcclxuICAgIHRhc2sucHV0VGFzaygpO1xyXG59KVxyXG59IFxyXG5cclxuZXhwb3J0IGRlZmF1bHQgcmVmcmVzaFN0b3JhZ2VkOyAiLCJpbXBvcnQgeyBvcGVuTW9kYWwsIGNsb3NlTW9kYWwgfSBmcm9tIFwiLi9tb2RhbEFwcGVhcmVuY2VcIjsgXHJcbmltcG9ydCBtYWtlVGFzayBmcm9tIFwiLi90YXNrRmFjdG9yeVwiO1xyXG5pbXBvcnQgc2hvd1Rhc2sgZnJvbSBcIi4vc2hvd1Rhc2tcIjtcclxuaW1wb3J0IHRyYW5zZmVyVGFzayBmcm9tIFwiLi90cmFuc2ZlclRvRGVsZXRlZFwiO1xyXG5pbXBvcnQgcmV0dXJuRnJvbUNvbXBsZXRlZCBmcm9tIFwiLi9yZXR1cm5Gcm9tRGVsZXRlZFwiO1xyXG5pbXBvcnQge29wZW5Nb2RhbEluZm8sIGNsb3NlTW9kYWxJbmZvfSBmcm9tIFwiLi9tb2RhbEluZm9BcHBlYXJlbmNlXCI7XHJcbmltcG9ydCBsaWdodFRoZVRhZyBmcm9tIFwiLi9saWdodFRoZUNob3NlblRhZ1wiO1xyXG5pbXBvcnQgY2hvc2VUYWcgZnJvbSBcIi4vY2hvc2VUYWdcIjtcclxuaW1wb3J0IGFwcGx5Q2hhbmdlcyBmcm9tIFwiLi9hcHBseUNoYW5nZXNcIjtcclxuaW1wb3J0IGNoYW5nZURlYWRsaW5lIGZyb20gXCIuL2NoYW5nZURlYWRsaW5lXCI7XHJcbmltcG9ydCB7c2hvd1RhZ2VkVGFza3MsIGNsZWFuRmlsdGVyc30gZnJvbSBcIi4vc2hvd1RhZ2VkVGFza3NcIjtcclxuaW1wb3J0IGdldFRhc2sgZnJvbSBcIi4vZ2V0VGFza3NGcm9tU3RvcmFnZVwiO1xyXG5pbXBvcnQgcmVmcmVzaFN0b3JhZ2VkIGZyb20gXCIuL3JlbW92ZUZyb21TdG9yYWdlXCI7XHJcblxyXG5jb25zdCB0YXNrc0NvbGxlY3Rpb24gPSBbXTsgXHJcbmxldCBjaG9zZW5EZWFkbGluZSA9ICcnOyBcclxubGV0IGNob3NlblRhZ3MgPSBbXTtcclxuXHJcbi8vc2hvd3Mgc3RvcmFnZWQgdGFza3NcclxubGV0IHN0b3JhZ2VkVGFza3MgPSBnZXRUYXNrKCk7IFxyXG5pZiAoc3RvcmFnZWRUYXNrcyAhPSAwKSB7IFxyXG4gICAgc3RvcmFnZWRUYXNrcy5mb3JFYWNoKHRhc2sgPT4geyBcclxuICAgIGxldCBuZXdUYXNrID0gbWFrZVRhc2sodGFza1swXSwgdGFza1sxXSwgdGFza1syXSwgdGFza1szXSwgZ2V0VGFzayk7XHJcbiAgICB0YXNrc0NvbGxlY3Rpb24ucHVzaChuZXdUYXNrKTtcclxuICAgIHNob3dUYXNrKG5ld1Rhc2submFtZSwgbmV3VGFzay5kZWFkbGluZSwgbmV3VGFzay5pZCk7XHJcbiAgICB9KVxyXG59XHJcblxyXG4vL2FkZCBhIHRhc2sgYnV0dG9uIGZ1bmN0aW9uYWxpdHkgXHJcbmNvbnN0IGFkZEFUYXNrQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZEFUYXNrJyk7IFxyXG5cclxuYWRkQVRhc2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgKGUpID0+IHtcclxuICAgIGUudGFyZ2V0LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZ2IoMzYsIDE2MywgMjYpJztcclxufSlcclxuYWRkQVRhc2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIChlKSA9PiB7XHJcbiAgICBlLnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmdiKDI2LCAxNTMsIDI2KSdcclxufSlcclxuYWRkQVRhc2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBvcGVuTW9kYWwobGlnaHRUaGVUYWcsIGNob3NlblRhZ3MpO1xyXG59KVxyXG5cclxuLy9tb2R1bGUgb3ZlcmxheSBmdW5jdGlvbmFsaXR5XHJcbmNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheScpO1xyXG5cclxub3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIGNsb3NlTW9kYWwoKTtcclxuICAgIGNsb3NlTW9kYWxJbmZvKCk7XHJcbiAgICBjaG9zZW5EZWFkbGluZSA9ICcnO1xyXG4gICAgY2hvc2VuVGFncyA9IFtdO1xyXG59KVxyXG5cclxuLy9tb2RhbCBpbnB1dHMgZnVuY3Rpb25hbGl0eSBcclxuY29uc3QgdGFza05hbWVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbFRhc2tOYW1lJyk7IFxyXG4gXHJcbnRhc2tOYW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIChlKSA9PiB7IFxyXG4gICAgZS50YXJnZXQuc3R5bGUub3V0bGluZSA9ICdzb2xpZCc7XHJcbiAgICBlLnRhcmdldC5zdHlsZS5vdXRsaW5lV2lkdGggPSAnMXB4JztcclxuICAgIGUudGFyZ2V0LnN0eWxlLm91dGxpbmVDb2xvciA9ICdncmV5JztcclxufSlcclxuXHJcbnRhc2tOYW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIChlKSA9PiB7IFxyXG4gICAgZS50YXJnZXQuc3R5bGUub3V0bGluZSA9ICdub25lJ1xyXG59KVxyXG5cclxuLy9tb2RhbCB3aW5kb3cgZGVhZGxpbmVzIGZ1bmN0aW9uYWxpdHlcclxuY29uc3QgZGVhZGxpbmVzID0gQXJyYXkuZnJvbShkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdkZWFkbGluZScpKTtcclxuXHJcbmRlYWRsaW5lcy5mb3JFYWNoKGRlYWRsaW5lID0+IHsgXHJcbiAgICBkZWFkbGluZS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCAoZSk9PiB7XHJcbiAgICAgICAgaWYoY2hvc2VuRGVhZGxpbmUgPT09ICcnKXsgXHJcbiAgICAgICAgICAgIGUudGFyZ2V0LnN0eWxlLmNvbG9yID0gJ3JnYmEoMjYsIDE1MywgMjYpJztcclxuICAgICAgICAgfSAgICBcclxuICAgIH0pXHJcbiAgICBkZWFkbGluZS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIChlKT0+IHsgXHJcbiAgICAgICAgaWYoY2hvc2VuRGVhZGxpbmUgPT09ICcnKXsgXHJcbiAgICAgICAgICAgIGUudGFyZ2V0LnN0eWxlLmNvbG9yID0gJ3JnYig3OCwgNzgsIDc4KSc7XHJcbiAgICAgICAgIH0gICBcclxuICAgIH0pXHJcbn0pXHJcblxyXG4gICAgZm9yKGxldCBpPTA7IGk8ZGVhZGxpbmVzLmxlbmd0aDsgaSsrKXsgIC8vIHJlbWVtYmVycyB3aGljaCBkZWFkbGluZSBoYXZlIHlvdSBjaG9vc2UgXHJcblxyXG4gICAgIGRlYWRsaW5lc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKT0+IHtcclxuICAgICAgICAgICAgZGVhZGxpbmVzLmZvckVhY2goZGVhZGxpbmUgPT4geyAvL2NsZWFycyBvdGhlcnNcclxuICAgICAgICAgICAgIGRlYWRsaW5lLnN0eWxlLmNvbG9yID0gJ3JnYig3OCw3OCw3OCknXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIGUudGFyZ2V0LnN0eWxlLmNvbG9yID0gJ3JnYmEoMjYsIDE1MywgMjYpJzsgLy9oaWdobGlnaHRzIHRoZSBjaG9zZW5cclxuICAgICAgICAgICAgcmV0dXJuIGNob3NlbkRlYWRsaW5lID0gaTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuLy9zYXZlIHRhc2sgbW9kdWxlIGZ1bmN0aW9uYWxpdHkgXHJcbmNvbnN0IHNhdmVUYXNrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVUYXNrJyk7XHJcblxyXG5zYXZlVGFzay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIGlmKHRhc2tOYW1lSW5wdXQudmFsdWUgIT0gMCl7IFxyXG4gICAgLy9jcmVhdGVzIG5ldyB0YXNrIGFuZCBwdXNoIGl0IHRvIGNvbGxlY3Rpb25cclxuICAgIGNvbnN0IG5vdGVzQXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub3RlcycpO1xyXG4gICAgbGV0IG5ld1Rhc2sgPSBtYWtlVGFzayh0YXNrTmFtZUlucHV0LnZhbHVlLCBjaG9zZW5EZWFkbGluZSwgbm90ZXNBcmVhLnZhbHVlLCBjaG9zZW5UYWdzLCBnZXRUYXNrKTtcclxuICAgIG5ld1Rhc2sucHV0VGFzaygpO1xyXG4gICAgdGFza3NDb2xsZWN0aW9uLnB1c2gobmV3VGFzayk7XHJcbiAgICBzaG93VGFzayhuZXdUYXNrLm5hbWUsIG5ld1Rhc2suZGVhZGxpbmUsIG5ld1Rhc2suaWQpO1xyXG4gICAgLy9jbGVhcnMgbW9kdWxlIHdpbmRvd1xyXG4gICAgY2hvc2VuRGVhZGxpbmUgPSAnJzsgLy9yZXR1cm5zIGRlYWRsaW5lIHRvIHVuY2hvc2VuIFxyXG4gICAgY2hvc2VuVGFncyA9IFtdO1xyXG4gICAgY2xvc2VNb2RhbCgpOyBcclxuICAgfSBlbHNlIHsgXHJcbiAgICAgICBhbGVydChcIllvdSBzaG91bGQgZW50ZXIgYXQgbGVhc3QgbmFtZSBvZiB0aGUgdGFza1wiKVxyXG4gICB9XHJcbn0pXHJcblxyXG5zYXZlVGFzay5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCAoZSkgPT4ge1xyXG4gICAgZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3JnYigyNiwgMTUzLCAyNiknO1xyXG59KVxyXG5cclxuc2F2ZVRhc2suYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIChlKSA9PiB7XHJcbiAgICBlLnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndHJhbnNwYXJlbnQnO1xyXG59KVxyXG5cclxuLy9kZWFkbGluZVdyYXBwZXIgZnVuY3Rpb25hbGl0eSBcclxuY29uc3QgdG9kb0RlYWRsaW5lcyA9IEFycmF5LmZyb20oZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndG9kb0RlYWRsaW5lJykpO1xyXG50b2RvRGVhZGxpbmVzLmZvckVhY2godG9kb0RlYWRsaW5lID0+IHsgXHJcbiAgICB0b2RvRGVhZGxpbmUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgKGUpID0+IHsgXHJcbiAgICAgICAgaWYoIWUudGFyZ2V0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcpe1xyXG4gICAgICAgICAgICBlLnRhcmdldC5zdHlsZS5ib3JkZXJCb3R0b20gPSAnMS41cHggc29saWQgZ3JleSc7XHJcbiAgICAgICAgICAgIGUudGFyZ2V0LnN0eWxlLmNvbG9yID0gJ2JsYWNrJztcclxuICAgICAgICB9IGVsc2UgeyBcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuYWRkKCdtb3VzZW9uJyk7XHJcbiAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICB0b2RvRGVhZGxpbmUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIChlKSA9PiB7IFxyXG4gICAgICAgIGlmKCFlLnRhcmdldC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKXtcclxuICAgICAgICAgICAgZS50YXJnZXQuc3R5bGUuYm9yZGVyQm90dG9tID0gJ25vbmUnO1xyXG4gICAgICAgICAgICBlLnRhcmdldC5zdHlsZS5jb2xvciA9ICdyZ2IoMTAwLCAxMDAsIDEwMCknO1xyXG4gICAgICAgIH0gZWxzZSB7IFxyXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ21vdXNlb24nKTtcclxuICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIHRvZG9EZWFkbGluZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7IFxyXG4gICAgICAgIGlmKGUudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZy5zdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpeyBcclxuICAgICAgICAgICAgZS50YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICAgICAgfSBlbHNlIHsgXHJcbiAgICAgICAgICAgIGUudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfSlcclxufSlcclxuXHJcbi8vY29tcGxldGVCdXR0b25zIGZ1bmNpb25hbGl0eSAgXHJcbmNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JylcclxuYm9keS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7IFxyXG4gICAgaWYoZS50YXJnZXQubWF0Y2hlcygnLmNvbXBsZXRlQ2lyY2xlJykpIHsgXHJcbiAgICAgICB0cmFuc2ZlclRhc2soZSwgdGFza3NDb2xsZWN0aW9uKTtcclxuICAgICAgIGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB9XHJcbn0pXHJcblxyXG5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIChlKSA9PiB7IFxyXG4gICAgaWYoZS50YXJnZXQubWF0Y2hlcygnLmNvbXBsZXRlQ2lyY2xlJykpIHsgXHJcbiAgICAgICAgZS50YXJnZXQuc3R5bGUuYm9yZGVyID0gJzJweCBzb2xpZCBncmVlbidcclxuICAgIH1cclxufSlcclxuXHJcbmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCAoZSkgPT4geyBcclxuICAgIGlmKGUudGFyZ2V0Lm1hdGNoZXMoJy5jb21wbGV0ZUNpcmNsZScpKSB7IFxyXG4gICAgICAgIGUudGFyZ2V0LnN0eWxlLmJvcmRlciA9ICcxLjk5cHggc29saWQgYmxhY2snXHJcbiAgICB9XHJcbn0pXHJcblxyXG5cclxuLy9jb21wbGV0ZWRUYXNrcyBmdW5jdGlvbmFsaXR5IFxyXG5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIChlKSA9PiB7IFxyXG4gICAgaWYoZS50YXJnZXQubWF0Y2hlcygnLmNvbXBsZXRlZFRhc2snKSkgeyBcclxuICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ21vdXNlb24nKTsgXHJcbiAgICB9XHJcbn0pXHJcblxyXG5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgKGUpID0+IHsgXHJcbiAgICBpZihlLnRhcmdldC5tYXRjaGVzKCcuY29tcGxldGVkVGFzaycpKSB7IFxyXG4gICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgnbW91c2VvbicpOyBcclxuICAgIH1cclxufSlcclxuXHJcbmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSk9PiB7IC8vbWFrZXMgY29tcGxldGVkIHRhc2tzIG9uIGNsaWNrIHJldHVybiBiYWNrIHRvIGl0J3MgcGxhY2VcclxuICAgIGlmKGUudGFyZ2V0Lm1hdGNoZXMoJy5jb21wbGV0ZWRUYXNrJykpIHsgXHJcbiAgICAgICAgc2hvd1Rhc2socmV0dXJuRnJvbUNvbXBsZXRlZChlLCB0YXNrc0NvbGxlY3Rpb24pWzBdLHJldHVybkZyb21Db21wbGV0ZWQoZSwgdGFza3NDb2xsZWN0aW9uKVsxXSxyZXR1cm5Gcm9tQ29tcGxldGVkKGUsIHRhc2tzQ29sbGVjdGlvbilbMl0pO1xyXG4gICAgICAgIGUudGFyZ2V0LnJlbW92ZSgpO1xyXG4gICAgIH1cclxuIH0pXHJcblxyXG4gLy90YWdzIGZ1bmN0aW9uYWxpdHkgXHJcbmNvbnN0IHRhZ3MgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWcnKSk7IC8vYWRkcyB0YWdzIHRvIGNob3NlbiBhcnJheSBhbmQgbGlnaHRzIHVwIGNob3NlblxyXG50YWdzLmZvckVhY2godGFnID0+IHsgIFxyXG4gICAgdGFnLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT4ge1xyXG4gICAgICAgIGNob3NlVGFnKGUsIGNob3NlblRhZ3MpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGNob3NlblRhZ3MpO1xyXG4gICAgICAgIGxpZ2h0VGhlVGFnKGNob3NlblRhZ3MpO1xyXG4gICAgfSlcclxufSlcclxuXHJcbiAvL3Rhc2sgaW5mbyBcclxuIGJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4geyBcclxuICAgICBpZihlLnRhcmdldC5tYXRjaGVzKCcudGFza05hbWUnKSl7XHJcbiAgICAgICAgIGNvbnNvbGUubG9nKGNob3NlblRhZ3MpXHJcbiAgICAgICAgIGNob3NlblRhZ3MgPSBvcGVuTW9kYWxJbmZvKGUsIGxpZ2h0VGhlVGFnLCB0YXNrc0NvbGxlY3Rpb24sIGNob3NlblRhZ3MpO1xyXG4gICAgICAgICBjb25zb2xlLmxvZyhjaG9zZW5UYWdzKVxyXG4gICAgIH0gXHJcbn0pIFxyXG5cclxuLy9hcHBseSBjaGFuZ2VzIGJ1dHRvbiAgXHJcbmNvbnN0IGFwcGx5QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcGx5JylcclxuYXBwbHlCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4geyBcclxuICAgIGFwcGx5Q2hhbmdlcyhlLCBjaG9zZW5UYWdzLCB0YXNrc0NvbGxlY3Rpb24sIGNob3NlbkRlYWRsaW5lLCBzaG93VGFzaywgcmVmcmVzaFN0b3JhZ2VkLCBnZXRUYXNrKTsgXHJcbiAgICBjbG9zZU1vZGFsSW5mbygpO1xyXG59KVxyXG5cclxuLy9jaGFuZ2UgZGVhZGxpbmUgZnVuY3Rpb25hbGl0eVxyXG5jb25zdCBpbmZvRGVhZGxpbmUgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2luZm9EZWFkbGluZScpKTtcclxuXHJcbmluZm9EZWFkbGluZS5mb3JFYWNoKCBidXR0b24gPT4geyBcclxuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKT0+IHsgXHJcbiAgICAgICAgaW5mb0RlYWRsaW5lLmZvckVhY2goZGl2ID0+IHsgXHJcbiAgICAgICAgICAgIGRpdi5zdHlsZS5jb2xvciA9ICdyZ2IoNzgsNzgsNzgpJztcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBjaG9zZW5EZWFkbGluZSA9IGNoYW5nZURlYWRsaW5lKGUsIGNob3NlbkRlYWRsaW5lKTtcclxuICAgIH0pXHJcbn0pXHJcblxyXG4vL2NhbmNlbCBidXR0b24gZnVuY3Rpb25hbGl0eSBcclxuY29uc3QgY2FuY2VsQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbmNlbCcpOyBcclxuY2FuY2VsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7IFxyXG4gICAgY2xvc2VNb2RhbEluZm8oKTtcclxuICAgIGNob3NlbkRlYWRsaW5lID0gJyc7XHJcbiAgICBjaG9zZW5UYWdzID0gW107XHJcbn0pXHJcblxyXG4vL25hdmlnYXRpb24gZnVuY3Rpb25hbGl0eSBcclxuY29uc3QgbmF2aWdhdGlvblRhZ3MgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ25hdmlnYXRpb25UYWcnKSkgXHJcbm5hdmlnYXRpb25UYWdzLmZvckVhY2godGFnID0+IHtcclxuXHJcbiAgICB0YWcuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgKGUpID0+IHsgXHJcbiAgICAgICAgdGFnLmNsYXNzTGlzdC5hZGQoZS50YXJnZXQuaWQpXHJcbiAgICB9KVxyXG5cclxuICAgIHRhZy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKGUpID0+IHtcclxuICAgICAgICBpZighQXJyYXkuZnJvbShlLnRhcmdldC5jbGFzc0xpc3QudmFsdWUpLmluY2x1ZGVzKCdjJykpeyBcclxuICAgICAgICAgICAgdGFnLmNsYXNzTGlzdC5yZW1vdmUoZS50YXJnZXQuaWQpXHJcbiAgICAgICAgfVxyXG4gICAgICAgXHJcbiAgICB9KVxyXG5cclxuICAgIHRhZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICBcclxuICAgICAgICBpZihBcnJheS5mcm9tKGUudGFyZ2V0LmNsYXNzTGlzdC52YWx1ZSkuaW5jbHVkZXMoJ2MnKSl7XHJcbiAgICAgICAgICAgIHRhZy5jbGFzc0xpc3QucmVtb3ZlKGUudGFyZ2V0LmlkKVxyXG4gICAgICAgICAgICB0YWcuY2xhc3NMaXN0LnJlbW92ZSgnY2hvc2VuJylcclxuICAgICAgICAgICAgY2xlYW5GaWx0ZXJzKHRhc2tzQ29sbGVjdGlvbilcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbmF2aWdhdGlvblRhZ3MuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShlbGVtZW50LmlkKVxyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjaG9zZW4nKVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRhZy5jbGFzc0xpc3QuYWRkKGUudGFyZ2V0LmlkKVxyXG4gICAgICAgICAgICB0YWcuY2xhc3NMaXN0LmFkZCgnY2hvc2VuJylcclxuICAgICAgICAgICAgc2hvd1RhZ2VkVGFza3MoZSwgdGFza3NDb2xsZWN0aW9uKSAgXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuXHJcblxyXG59KSIsImZ1bmN0aW9uIHRyYW5zZmVyVGFzayhlLCB0YXNrc0NvbGxlY3Rpb24pIHsgXHJcbiAgICBjb25zdCB0YXNrSWQgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC52YWx1ZTtcclxuICAgIGxldCB0YXNrID0gMDtcclxuICAgIFxyXG4gICAgZm9yKGxldCBpPTA7IGk8dGFza3NDb2xsZWN0aW9uLmxlbmd0aDsgaSsrKXsgXHJcbiAgICAgICAgaWYodGFza0lkID09IHRhc2tzQ29sbGVjdGlvbltpXS5pZCkgeyBcclxuICAgICAgICAgICAgdGFzayA9IHRhc2tzQ29sbGVjdGlvbltpXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY29tcGxldGVkVGFza3NIb2xkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tcGV0ZWRUYXNrcycpOyBcclxuICAgIGNvbnN0IGNvbXBsZXRlZFRhc2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkZWwnKTsgXHJcbiAgICBjb21wbGV0ZWRUYXNrLmlubmVyVGV4dCA9IHRhc2submFtZTsgXHJcblxyXG4gICAgY29tcGxldGVkVGFzay5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZWRUYXNrJyk7XHJcbiAgICBjb21wbGV0ZWRUYXNrLnNldEF0dHJpYnV0ZSgnaWQnLCB0YXNrLmlkKVxyXG4gICAgY29tcGxldGVkVGFza3NIb2xkZXIuYXBwZW5kQ2hpbGQoY29tcGxldGVkVGFzayk7XHJcbn0gXHJcblxyXG5leHBvcnQgZGVmYXVsdCB0cmFuc2ZlclRhc2siLCJmdW5jdGlvbiBjaG9zZVRhZyhlLCBjaG9zZW5UYWdzKXtcclxuXHJcbiAgICBpZihjaG9zZW5UYWdzLmluY2x1ZGVzKGUudGFyZ2V0LmlubmVyVGV4dCkpeyBcclxuICAgICAgICBmb3IobGV0IGk9MDsgaTxjaG9zZW5UYWdzLmxlbmd0aDsgaSsrKXsgXHJcbiAgICAgICAgICAgaWYoY2hvc2VuVGFnc1tpXSA9PSBlLnRhcmdldC5pbm5lclRleHQpeyBcclxuICAgICAgICAgICAgICAgY2hvc2VuVGFncy5zcGxpY2UoaSwgMSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY2hvc2VuVGFncy5wdXNoKGUudGFyZ2V0LmlubmVyVGV4dClcclxuICAgIH1cclxuICAgIHJldHVybiBjaG9zZW5UYWdzXHJcbn0gXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjaG9zZVRhZ1xyXG4iLCJmdW5jdGlvbiBhcHBseUNoYW5nZXMoZSwgY2hvc2VuVGFncywgdGFza3NDb2xsZWN0aW9uLCBjaG9zZW5EZWFkbGluZSwgc2hvd1Rhc2ssICByZWZyZXNoU3RvcmFnZWQsIGdldFRhc2spIHsgXHJcblxyXG4gICAgLy90YWdzIGNoYW5nZVxyXG4gICAgY29uc3QgdGFza0lkID0gZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlO1xyXG4gICAgbGV0IHRhc2sgPSAnJztcclxuICAgIFxyXG4gICAgZm9yKGxldCBpPTA7IGk8dGFza3NDb2xsZWN0aW9uLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICBpZih0YXNrSWQgPT0gdGFza3NDb2xsZWN0aW9uW2ldLmlkKXsgXHJcbiAgICAgICAgICAgIHRhc2sgPSB0YXNrc0NvbGxlY3Rpb25baV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRhc2sudGFncyA9IGNob3NlblRhZ3M7XHJcbiAgICBlLnRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKHRhc2tJZClcclxuXHJcbiAgICAvL2RhdGUgY2hhbmdlXHJcbiAgICBpZih0YXNrLmRlYWRsaW5lICE9IGNob3NlbkRlYWRsaW5lKXsgXHJcbiAgICAgICAgdGFzay5kZWFkbGluZSA9IGNob3NlbkRlYWRsaW5lO1xyXG4gICAgICAgIGxldCBvbGRUYXNrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFzay5pZClcclxuICAgICAgICBvbGRUYXNrLnBhcmVudEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgc2hvd1Rhc2sodGFzay5uYW1lLCB0YXNrLmRlYWRsaW5lLCB0YXNrLmlkKTtcclxuICAgIH1cclxuXHJcbiAgICByZWZyZXNoU3RvcmFnZWQodGFza3NDb2xsZWN0aW9uLCBnZXRUYXNrKVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhcHBseUNoYW5nZXMiLCJmdW5jdGlvbiBjaGFuZ2VEZWFkbGluZShlLCBjaG9zZW5EZWFkbGluZSl7XHJcblxyXG4gICAgZS50YXJnZXQuc3R5bGUuY29sb3IgPSAncmdiKDI2LCAxNTMsIDI2KSc7XHJcbiAgICBcclxuICAgIGlmKGUudGFyZ2V0LmlubmVyVGV4dCA9PSAnVG9kYXknKXsgXHJcbiAgICAgICAgY2hvc2VuRGVhZGxpbmUgPSAwO1xyXG4gICAgfVxyXG4gICAgaWYoZS50YXJnZXQuaW5uZXJUZXh0ID09ICdUb21tb3JvdycpeyBcclxuICAgICAgICBjaG9zZW5EZWFkbGluZSA9IDE7XHJcbiAgICB9XHJcbiAgICBpZihlLnRhcmdldC5pbm5lclRleHQgPT0gJ1NvbWVkYXknKXsgXHJcbiAgICAgICAgY2hvc2VuRGVhZGxpbmUgPSAyO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICByZXR1cm4gY2hvc2VuRGVhZGxpbmVcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2hhbmdlRGVhZGxpbmUiLCJmdW5jdGlvbiBzaG93VGFnZWRUYXNrcyhlLCB0YXNrc0NvbGxlY3Rpb24peyBcclxuICAgIGNvbnN0IGNob3NlblRhZyA9IGUudGFyZ2V0LmlubmVyVGV4dFxyXG4gICAgY29uc3QgdGFza3MgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3Rhc2tOYW1lJykpO1xyXG4gICAgbGV0IG1hdGNoZWRUYXNrcyA9IFtdO1xyXG5cclxuICAgIGZvcihsZXQgaT0wOyBpPHRhc2tzQ29sbGVjdGlvbi5sZW5ndGg7IGkrKyl7IFxyXG4gICAgICAgIGZvcihsZXQgaj0wOyBqPHRhc2tzQ29sbGVjdGlvbi5sZW5ndGg7IGorKyl7IFxyXG4gICAgICAgICAgICBpZihjaG9zZW5UYWcgPT0gdGFza3NDb2xsZWN0aW9uW2ldLnRhZ3Nbal0peyBcclxuICAgICAgICAgICAgICAgIG1hdGNoZWRUYXNrcy5wdXNoKHRhc2tzQ29sbGVjdGlvbltpXS5pZClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0YXNrcy5mb3JFYWNoKHRhc2sgPT4ge1xyXG4gICAgICAgIHRhc2sucGFyZW50RWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIGZvcihsZXQgaT0wOyBpPHRhc2tzLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgaWYobWF0Y2hlZFRhc2tzW2ldID09IHRhc2suaWQpeyBcclxuICAgICAgICAgICAgICAgIHRhc2sucGFyZW50RWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufVxyXG5cclxuZnVuY3Rpb24gY2xlYW5GaWx0ZXJzKHRhc2tzQ29sbGVjdGlvbil7IFxyXG4gICAgY29uc3QgdGFza3MgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3Rhc2tOYW1lJykpO1xyXG4gICAgdGFza3MuZm9yRWFjaCh0YXNrID0+IHtcclxuICAgICAgICAgICAgdGFzay5wYXJlbnRFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICB9KVxyXG59XHJcblxyXG5leHBvcnQge3Nob3dUYWdlZFRhc2tzLCBjbGVhbkZpbHRlcnN9Il0sIm5hbWVzIjpbImNsb3NlTW9kYWwiLCJtb2RhbCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJvdmVybGF5IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidmFsdWUiLCJuYW1lIiwiZGVhZGxpbmUiLCJub3RlcyIsInRhZ3MiLCJnZXRUYXNrIiwiaWQiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJwdXRUYXNrIiwidGFza3MiLCJ0YXNrIiwidGhpcyIsInB1c2giLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJhZGQiLCJjb25zb2xlIiwibG9nIiwiY29tcGxldGVDaXJjbGUiLCJ0YXNrTmFtZSIsImlubmVyVGV4dCIsImFwcGVuZENoaWxkIiwiZSIsInRhc2tzQ29sbGVjdGlvbiIsInRhc2tJZCIsInRhcmdldCIsImkiLCJsZW5ndGgiLCJjbG9zZU1vZGFsSW5mbyIsIm1vZGFsSW5mbyIsImFwcGx5QnV0dG9uIiwiY29udGFpbnMiLCJjaG9zZW5UYWdzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImluY2x1ZGVzIiwidGFza3NMb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwicGFyc2UiLCJjbGVhciIsImZvckVhY2giLCJjaG9zZW5EZWFkbGluZSIsInN0b3JhZ2VkVGFza3MiLCJuZXdUYXNrIiwiYWRkQVRhc2tCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwic3R5bGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJsaWdodFRoZVRhZyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJjb2xvciIsIm9wZW5Nb2RhbCIsInRhc2tOYW1lSW5wdXQiLCJvdXRsaW5lIiwib3V0bGluZVdpZHRoIiwib3V0bGluZUNvbG9yIiwiZGVhZGxpbmVzIiwic2F2ZVRhc2siLCJub3Rlc0FyZWEiLCJhbGVydCIsInRvZG9EZWFkbGluZSIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJib3JkZXJCb3R0b20iLCJuZXh0RWxlbWVudFNpYmxpbmciLCJkaXNwbGF5IiwiYm9keSIsInF1ZXJ5U2VsZWN0b3IiLCJtYXRjaGVzIiwicGFyZW50RWxlbWVudCIsImNvbXBsZXRlZFRhc2tzSG9sZGVyIiwiY29tcGxldGVkVGFzayIsImJvcmRlciIsInRhZyIsInNwbGljZSIsImluZm9EZWFkbGluZXMiLCJlbGVtZW50Iiwib3Blbk1vZGFsSW5mbyIsInNob3dUYXNrIiwicmVmcmVzaFN0b3JhZ2VkIiwiaW5mb0RlYWRsaW5lIiwiYnV0dG9uIiwiZGl2IiwibmF2aWdhdGlvblRhZ3MiLCJjaG9zZW5UYWciLCJtYXRjaGVkVGFza3MiLCJqIiwic2hvd1RhZ2VkVGFza3MiXSwic291cmNlUm9vdCI6IiJ9