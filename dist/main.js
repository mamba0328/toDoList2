(()=>{"use strict";function e(){const e=document.getElementById("modalWindow"),t=document.getElementById("overlay");e.classList.remove("active"),t.classList.remove("active"),document.getElementById("notes").value="",document.getElementById("modalTaskName").value=""}const t=function(e,t,n){const a=document.createElement("div");a.setAttribute("id","task"),a.classList.add(n),console.log(a.classList.value);const s=document.createElement("div");s.classList.add("completeCircle");const o=document.createElement("h3");o.classList.add("taskName"),o.setAttribute("id",n),o.innerText=e,a.appendChild(s),a.appendChild(o),0==t?document.getElementById("todayHolder").appendChild(a):1==t?document.getElementById("tommorowHolder").appendChild(a):document.getElementById("somedayHolder").appendChild(a)},n=function(e,t){const n=e.target.id;let a="";for(let e=0;e<t.length;e++)n==t[e].id&&(a=t[e]);return[a.name,a.deadline,a.id]};function a(){const e=document.getElementById("modalInfo"),t=document.getElementById("overlay");e.classList.remove("active"),t.classList.remove("active");const n=document.getElementById("apply");n.classList.contains(n.classList.value)&&n.classList.remove(n.classList.value)}const s=function(e){const t=Array.from(document.querySelectorAll(".tag"));for(let n=0;n<t.length;n++)e.includes(t[n].id)?t[n].classList.add("chosen"):t[n].classList.remove("chosen")},o=[];let l="",r=[];const d=document.getElementById("addATask");d.addEventListener("mouseover",(e=>{e.target.style.backgroundColor="rgb(36, 163, 26)"})),d.addEventListener("mouseleave",(e=>{e.target.style.backgroundColor="rgb(26, 153, 26)"})),d.addEventListener("click",(()=>{!function(e,t){e([]);const n=document.getElementById("modalWindow"),a=document.getElementById("overlay");n.classList.add("active"),a.classList.add("active"),Array.from(document.getElementsByClassName("deadline")).forEach((e=>{e.style.color="rgb(78,78,78)"}))}(s)})),document.getElementById("overlay").addEventListener("click",(()=>{e(),a(),l="",r=[]}));const c=document.getElementById("modalTaskName");c.addEventListener("mouseenter",(e=>{e.target.style.outline="solid",e.target.style.outlineWidth="1px",e.target.style.outlineColor="grey"})),c.addEventListener("mouseleave",(e=>{e.target.style.outline="none"}));const i=Array.from(document.getElementsByClassName("deadline"));i.forEach((e=>{e.addEventListener("mouseover",(e=>{""===l&&(e.target.style.color="rgba(26, 153, 26)")})),e.addEventListener("mouseout",(e=>{""===l&&(e.target.style.color="rgb(78, 78, 78)")}))}));for(let e=0;e<i.length;e++)i[e].addEventListener("click",(t=>(i.forEach((e=>{e.style.color="rgb(78,78,78)"})),t.target.style.color="rgba(26, 153, 26)",l=e)));const m=document.getElementById("saveTask");m.addEventListener("click",(()=>{const n=document.getElementById("notes");let a=function(e,t="today",n="",a=""){return{name:e,deadline:t,notes:n,tags:a,id:Math.floor(1e5*Math.random())}}(c.value,l,n.value,r);o.push(a),t(a.name,a.deadline,a.id),l="",r=[],e()})),m.addEventListener("mouseover",(e=>{e.target.style.backgroundColor="rgb(26, 153, 26)"})),m.addEventListener("mouseleave",(e=>{e.target.style.backgroundColor="transparent"})),Array.from(document.getElementsByClassName("todoDeadline")).forEach((e=>{e.addEventListener("mouseover",(e=>{e.target.previousElementSibling?e.target.classList.add("mouseon"):(e.target.style.borderBottom="1.5px solid grey",e.target.style.color="black")})),e.addEventListener("mouseleave",(e=>{e.target.previousElementSibling?e.target.classList.remove("mouseon"):(e.target.style.borderBottom="none",e.target.style.color="rgb(100, 100, 100)")})),e.addEventListener("click",(e=>{"none"===e.target.nextElementSibling.style.display?e.target.nextElementSibling.style.display="flex":e.target.nextElementSibling.style.display="none"}))}));const g=document.querySelector("body");g.addEventListener("click",(e=>{e.target.matches(".completeCircle")&&(function(e,t){const n=e.target.parentElement.classList.value;let a=0;for(let e=0;e<t.length;e++)n==t[e].id&&(a=t[e]);const s=document.getElementById("competedTasks"),o=document.createElement("del");o.innerText=a.name,o.classList.add("completedTask"),o.setAttribute("id",a.id),s.appendChild(o)}(e,o),e.target.parentElement.remove())})),g.addEventListener("mouseover",(e=>{e.target.matches(".completeCircle")&&(e.target.style.border="2px solid green")})),g.addEventListener("mouseout",(e=>{e.target.matches(".completeCircle")&&(e.target.style.border="1.99px solid black")})),g.addEventListener("mouseover",(e=>{e.target.matches(".completedTask")&&e.target.classList.add("mouseon")})),g.addEventListener("mouseout",(e=>{e.target.matches(".completedTask")&&e.target.classList.remove("mouseon")})),g.addEventListener("click",(e=>{e.target.matches(".completedTask")&&(t(n(e,o)[0],n(e,o)[1],n(e,o)[2]),e.target.remove())})),Array.from(document.querySelectorAll(".tag")).forEach((e=>{e.addEventListener("click",(e=>{(function(e,t){if(t.includes(e.target.innerText))for(let n=0;n<t.length;n++)t[n]==e.target.innerText&&t.splice(n,1);else t.push(e.target.innerText)})(e,r),console.log(r),s(r)}))})),g.addEventListener("click",(e=>{e.target.matches(".taskName")&&(console.log(r),r=function(e,t,n,a){const s=e.target.parentElement.classList.value;let o="";for(let e=0;e<n.length;e++)s==n[e].id&&(o=n[e]);a=o.tags,t(o.tags),document.getElementById("taskInfoName").innerText=o.name,document.getElementById("taskInfoNotes").innerText=o.notes;const l=document.getElementById("modalInfo"),r=document.getElementById("overlay");l.classList.add("active"),r.classList.add("active");const d=Array.from(document.getElementsByClassName("infoDeadline"));return d.forEach((e=>{e.style.color="rgb(78,78,78)"})),0==o.deadline&&(d[0].style.color="rgba(26, 153, 26)"),1==o.deadline&&(d[1].style.color="rgba(26, 153, 26)"),2==o.deadline&&(d[2].style.color="rgba(26, 153, 26)"),document.getElementById("apply").classList.add(s),a}(e,s,o,r),console.log(r))})),document.getElementById("apply").addEventListener("click",(e=>{(function(e,t,n,a,s){const o=e.target.classList.value;let l="";for(let e=0;e<n.length;e++)o==n[e].id&&(l=n[e]);l.tags=t,e.target.classList.remove(o),l.deadline!=a&&(l.deadline=a,document.getElementById(l.id).parentElement.remove(),s(l.name,l.deadline,l.id))})(e,r,o,l,t),a()}));const u=Array.from(document.getElementsByClassName("infoDeadline"));u.forEach((e=>{e.addEventListener("click",(e=>{u.forEach((e=>{e.style.color="rgb(78,78,78)"})),l=function(e,t){return e.target.style.color="rgb(26, 153, 26)","Today"==e.target.innerText&&(t=0),"Tommorow"==e.target.innerText&&(t=1),"Someday"==e.target.innerText&&(t=2),t}(e,l)}))})),document.getElementById("cancel").addEventListener("click",(()=>{a(),l="",r=[]}));const y=Array.from(document.getElementsByClassName("navigationTag"));y.forEach((e=>{e.addEventListener("mouseover",(t=>{e.classList.add(t.target.id)})),e.addEventListener("mouseleave",(t=>{Array.from(t.target.classList.value).includes("c")||e.classList.remove(t.target.id)})),e.addEventListener("click",(t=>{Array.from(t.target.classList.value).includes("c")?(e.classList.remove(t.target.id),e.classList.remove("chosen"),Array.from(document.getElementsByClassName("taskName")).forEach((e=>{e.parentElement.style.display="flex"}))):(y.forEach((e=>{e.classList.remove(e.id),e.classList.remove("chosen")})),e.classList.add(t.target.id),e.classList.add("chosen"),function(e,t){const n=e.target.innerText,a=Array.from(document.getElementsByClassName("taskName"));let s=[];for(let e=0;e<t.length;e++)for(let a=0;a<t.length;a++)n==t[e].tags[a]&&s.push(t[e].id);a.forEach((e=>{e.parentElement.style.display="none";for(let t=0;t<a.length;t++)s[t]==e.id&&(e.parentElement.style.display="flex")}))}(t,o))}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FFbkIsSUFBSSxJQUFJM0QsRUFBRSxFQUFHQSxFQUFFSCxFQUFnQkksT0FBUUQsSUFDbkMsSUFBSSxJQUFJNEQsRUFBRSxFQUFHQSxFQUFFL0QsRUFBZ0JJLE9BQVEyRCxJQUNoQ0gsR0FBYTVELEVBQWdCRyxHQUFHTyxLQUFLcUQsSUFDcENELEVBQWF6QixLQUFLckMsRUFBZ0JHLEdBQUdmLElBS2pEeUUsRUFBTXZDLFNBQVFqQyxJQUNWQSxFQUFLeUQsY0FBYzVCLE1BQU13QixRQUFVLE9BQ25DLElBQUksSUFBSXZDLEVBQUUsRUFBR0EsRUFBRTBELEVBQU16RCxPQUFRRCxJQUN0QjJELEVBQWEzRCxJQUFNZCxFQUFLRCxLQUN2QkMsRUFBS3lELGNBQWM1QixNQUFNd0IsUUFBVSxXTDJPdkNzQixDQUFlakUsRUFBR0MsVyIsInNvdXJjZXMiOlsid2VicGFjazovL3RvZG9saXN0Mi8uL3NyYy9tb2RhbEFwcGVhcmVuY2UuanMiLCJ3ZWJwYWNrOi8vdG9kb2xpc3QyLy4vc3JjL3Rhc2tGYWN0b3J5LmpzIiwid2VicGFjazovL3RvZG9saXN0Mi8uL3NyYy9zaG93VGFzay5qcyIsIndlYnBhY2s6Ly90b2RvbGlzdDIvLi9zcmMvcmV0dXJuRnJvbURlbGV0ZWQuanMiLCJ3ZWJwYWNrOi8vdG9kb2xpc3QyLy4vc3JjL21vZGFsSW5mb0FwcGVhcmVuY2UuanMiLCJ3ZWJwYWNrOi8vdG9kb2xpc3QyLy4vc3JjL2xpZ2h0VGhlQ2hvc2VuVGFnLmpzIiwid2VicGFjazovL3RvZG9saXN0Mi8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly90b2RvbGlzdDIvLi9zcmMvdHJhbnNmZXJUb0RlbGV0ZWQuanMiLCJ3ZWJwYWNrOi8vdG9kb2xpc3QyLy4vc3JjL2Nob3NlVGFnLmpzIiwid2VicGFjazovL3RvZG9saXN0Mi8uL3NyYy9hcHBseUNoYW5nZXMuanMiLCJ3ZWJwYWNrOi8vdG9kb2xpc3QyLy4vc3JjL2NoYW5nZURlYWRsaW5lLmpzIiwid2VicGFjazovL3RvZG9saXN0Mi8uL3NyYy9zaG93VGFnZWRUYXNrcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBvcGVuTW9kYWwobGlnaHRUaGVUYWcsIGNob3NlblRhZ3MpIHsgXHJcbiAgICBjaG9zZW5UYWdzID0gW107XHJcbiAgICBsaWdodFRoZVRhZyhjaG9zZW5UYWdzKTtcclxuICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsV2luZG93Jyk7XHJcbiAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXknKVxyXG4gICAgbW9kYWwuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICBvdmVybGF5LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgY29uc3QgZGVhZGxpbmVzID0gQXJyYXkuZnJvbShkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdkZWFkbGluZScpKTtcclxuICAgIGRlYWRsaW5lcy5mb3JFYWNoKGRlYWRsaW5lID0+IHsgXHJcbiAgICAgICAgZGVhZGxpbmUuc3R5bGUuY29sb3IgPSAncmdiKDc4LDc4LDc4KSdcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWwoKSB7IFxyXG4gICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxXaW5kb3cnKTtcclxuICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheScpO1xyXG4gICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICBvdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgY29uc3QgdGV4dEFyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm90ZXMnKTtcclxuICAgIHRleHRBcmVhLnZhbHVlID0gJyc7XHJcbiAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbFRhc2tOYW1lJyk7XHJcbiAgICBpbnB1dC52YWx1ZSA9ICcnO1xyXG59XHJcblxyXG5leHBvcnQge29wZW5Nb2RhbCwgXHJcbmNsb3NlTW9kYWx9ICIsImZ1bmN0aW9uIG1ha2VUYXNrKG5hbWUsIGRlYWRsaW5lID0gJ3RvZGF5Jywgbm90ZXMgPSAnJywgdGFncyA9ICcnKXsgXHJcblxyXG4gICAgbGV0IGlkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjEwMDAwMCk7IC8vbmVlZGVkIHRvIGlkZW50aWZ5IHRhc2sgXHJcbiAgICByZXR1cm4ge25hbWUsIGRlYWRsaW5lLCBub3RlcywgdGFncywgaWR9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IG1ha2VUYXNrOyIsImZ1bmN0aW9uIHNob3dUYXNrKG5hbWUsIGRlYWRsaW5lLCBpZCkgeyBcclxuICAgIGNvbnN0IHRhc2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHRhc2suc2V0QXR0cmlidXRlKCdpZCcsICd0YXNrJyk7XHJcblxyXG4gICAgdGFzay5jbGFzc0xpc3QuYWRkKGlkKTtcclxuICAgIGNvbnNvbGUubG9nKHRhc2suY2xhc3NMaXN0LnZhbHVlKTtcclxuXHJcbiAgICBjb25zdCBjb21wbGV0ZUNpcmNsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29tcGxldGVDaXJjbGUuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVDaXJjbGUnKTtcclxuXHJcbiAgICBjb25zdCB0YXNrTmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XHJcbiAgICB0YXNrTmFtZS5jbGFzc0xpc3QuYWRkKCd0YXNrTmFtZScpXHJcbiAgICB0YXNrTmFtZS5zZXRBdHRyaWJ1dGUoJ2lkJywgaWQpO1xyXG4gICAgdGFza05hbWUuaW5uZXJUZXh0ID0gbmFtZTtcclxuXHJcbiAgICB0YXNrLmFwcGVuZENoaWxkKGNvbXBsZXRlQ2lyY2xlKTtcclxuICAgIHRhc2suYXBwZW5kQ2hpbGQodGFza05hbWUpO1xyXG5cclxuICAgIC8vY2hla3MgaW4gd2hpY2ggdGFza1pvbmUgaXQgd2lsbCBiZSBzZW50IFxyXG5cclxuICAgIGlmKGRlYWRsaW5lID09IDApeyBcclxuICAgICAgICBjb25zdCB0b2RheUhvbGRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2RheUhvbGRlcicpOyBcclxuICAgICAgICB0b2RheUhvbGRlci5hcHBlbmRDaGlsZCh0YXNrKTtcclxuICAgIH0gZWxzZSBpZiggZGVhZGxpbmUgPT0gMSkgeyBcclxuICAgICAgICBjb25zdCB0b21tb3Jvd0hvbGRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b21tb3Jvd0hvbGRlcicpOyBcclxuICAgICAgICB0b21tb3Jvd0hvbGRlci5hcHBlbmRDaGlsZCh0YXNrKTtcclxuICAgIH0gZWxzZSB7IFxyXG4gICAgICAgIGNvbnN0IHNvbWVkYXlIb2xkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc29tZWRheUhvbGRlcicpO1xyXG4gICAgICAgIHNvbWVkYXlIb2xkZXIuYXBwZW5kQ2hpbGQodGFzayk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IHNob3dUYXNrOyAiLCJmdW5jdGlvbiByZXR1cm5Gcm9tQ29tcGxldGVkKGUsIHRhc2tzQ29sbGVjdGlvbikgeyBcclxuXHJcbiAgICBjb25zdCB0YXNrSWQgPSBlLnRhcmdldC5pZDtcclxuICAgIGxldCB0YXNrID0gJyc7XHJcblxyXG4gICAgZm9yKGxldCBpPTA7IGk8dGFza3NDb2xsZWN0aW9uLmxlbmd0aDsgaSsrKXsgXHJcbiAgICAgICAgaWYodGFza0lkID09IHRhc2tzQ29sbGVjdGlvbltpXS5pZCkgeyBcclxuICAgICAgICAgICAgdGFzayA9IHRhc2tzQ29sbGVjdGlvbltpXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCBwcm9wZXJ0aWVzID0gW3Rhc2submFtZSwgdGFzay5kZWFkbGluZSwgdGFzay5pZF07XHJcbiAgICByZXR1cm4gcHJvcGVydGllc1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCByZXR1cm5Gcm9tQ29tcGxldGVkOyIsImZ1bmN0aW9uIG9wZW5Nb2RhbEluZm8oZSwgbGlnaHRUaGVUYWcsIHRhc2tzQ29sbGVjdGlvbiwgY2hvc2VuVGFncykge1xyXG4gICAgLy9zaG93cyB3aGljaCB0YWdzIHRoZSB0YXNrIGhhc1xyXG4gICAgY29uc3QgdGFza0lkID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QudmFsdWU7XHJcbiAgICBsZXQgdGFzayA9ICcnO1xyXG4gICAgXHJcbiAgICBmb3IobGV0IGk9MDsgaTx0YXNrc0NvbGxlY3Rpb24ubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgIGlmKHRhc2tJZCA9PSB0YXNrc0NvbGxlY3Rpb25baV0uaWQpeyBcclxuICAgICAgICAgICAgdGFzayA9IHRhc2tzQ29sbGVjdGlvbltpXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2hvc2VuVGFncyA9IHRhc2sudGFnc1xyXG4gICAgbGlnaHRUaGVUYWcodGFzay50YWdzKVxyXG5cclxuICAgIC8vY2hhbmdlcyBuYW1lIHRvIHRhc2tzIFxyXG4gICAgY29uc3QgdGFza05hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFza0luZm9OYW1lJylcclxuICAgIHRhc2tOYW1lLmlubmVyVGV4dCA9IHRhc2submFtZVxyXG5cclxuICAgIC8vY2hhbmdlcyBub3RlcyB0byB0YXNrc1xyXG4gICAgY29uc3QgdGFza05vdGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2tJbmZvTm90ZXMnKVxyXG4gICAgdGFza05vdGVzLmlubmVyVGV4dCA9IHRhc2subm90ZXNcclxuXHJcbiAgICBjb25zdCBtb2RhbEluZm8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxJbmZvJyk7XHJcbiAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXknKTtcclxuICAgIG1vZGFsSW5mby5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgIG92ZXJsYXkuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcblxyXG4gICAgLy9jaGFuZ2VzIGRlYWRsaW5lIFxyXG4gICAgY29uc3QgaW5mb0RlYWRsaW5lcyA9IEFycmF5LmZyb20oZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnaW5mb0RlYWRsaW5lJykpO1xyXG5cclxuICAgIGluZm9EZWFkbGluZXMuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICBlbGVtZW50LnN0eWxlLmNvbG9yID0gJ3JnYig3OCw3OCw3OCknXHJcbiAgICB9KTtcclxuXHJcbiAgICBpZih0YXNrLmRlYWRsaW5lID09IDApeyBcclxuICAgICAgICBpbmZvRGVhZGxpbmVzWzBdLnN0eWxlLmNvbG9yID0gJ3JnYmEoMjYsIDE1MywgMjYpJ1xyXG4gICAgfVxyXG4gICAgaWYodGFzay5kZWFkbGluZSA9PSAxKXsgXHJcbiAgICAgICAgaW5mb0RlYWRsaW5lc1sxXS5zdHlsZS5jb2xvciA9ICdyZ2JhKDI2LCAxNTMsIDI2KSdcclxuICAgIH1cclxuICAgIGlmKHRhc2suZGVhZGxpbmUgPT0gMil7IFxyXG4gICAgICAgIGluZm9EZWFkbGluZXNbMl0uc3R5bGUuY29sb3IgPSAncmdiYSgyNiwgMTUzLCAyNiknXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYXBwbHlCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHknKVxyXG4gICAgYXBwbHlCdXR0b24uY2xhc3NMaXN0LmFkZCh0YXNrSWQpIC8vaGVscHMgaW4gZnVydGhlciBpZGVudGlkaWNhdGlvblxyXG4gICAgXHJcbiAgICByZXR1cm4gY2hvc2VuVGFnc1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsSW5mbygpIHsgXHJcbiAgICBjb25zdCBtb2RhbEluZm8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxJbmZvJyk7XHJcbiAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXknKTtcclxuICAgIG1vZGFsSW5mby5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgIG92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcblxyXG4gICAgY29uc3QgYXBwbHlCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHknKVxyXG4gICAgXHJcbiAgICBpZihhcHBseUJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoYXBwbHlCdXR0b24uY2xhc3NMaXN0LnZhbHVlKSl7XHJcbiAgICBhcHBseUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKGFwcGx5QnV0dG9uLmNsYXNzTGlzdC52YWx1ZSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7b3Blbk1vZGFsSW5mbyxjbG9zZU1vZGFsSW5mb30iLCJmdW5jdGlvbiBsaWdodFRoZVRhZyhjaG9zZW5UYWdzKSB7IFxyXG4gICAgY29uc3QgdGFncyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRhZycpKTtcclxuICAgIGZvcihsZXQgaT0wOyBpPHRhZ3MubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICBpZihjaG9zZW5UYWdzLmluY2x1ZGVzKHRhZ3NbaV0uaWQpKXtcclxuICAgICAgICAgICAgIHRhZ3NbaV0uY2xhc3NMaXN0LmFkZCgnY2hvc2VuJyk7XHJcbiAgICAgICAgIH0gZWxzZSB7IFxyXG4gICAgICAgICAgICB0YWdzW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ2Nob3NlbicpO1xyXG4gICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGxpZ2h0VGhlVGFnIiwiaW1wb3J0IHsgb3Blbk1vZGFsLCBjbG9zZU1vZGFsIH0gZnJvbSBcIi4vbW9kYWxBcHBlYXJlbmNlXCI7IFxyXG5pbXBvcnQgbWFrZVRhc2sgZnJvbSBcIi4vdGFza0ZhY3RvcnlcIjtcclxuaW1wb3J0IHNob3dUYXNrIGZyb20gXCIuL3Nob3dUYXNrXCI7XHJcbmltcG9ydCB0cmFuc2ZlclRhc2sgZnJvbSBcIi4vdHJhbnNmZXJUb0RlbGV0ZWRcIjtcclxuaW1wb3J0IHJldHVybkZyb21Db21wbGV0ZWQgZnJvbSBcIi4vcmV0dXJuRnJvbURlbGV0ZWRcIjtcclxuaW1wb3J0IHtvcGVuTW9kYWxJbmZvLCBjbG9zZU1vZGFsSW5mb30gZnJvbSBcIi4vbW9kYWxJbmZvQXBwZWFyZW5jZVwiO1xyXG5pbXBvcnQgbGlnaHRUaGVUYWcgZnJvbSBcIi4vbGlnaHRUaGVDaG9zZW5UYWdcIjtcclxuaW1wb3J0IGNob3NlVGFnIGZyb20gXCIuL2Nob3NlVGFnXCI7XHJcbmltcG9ydCBhcHBseUNoYW5nZXMgZnJvbSBcIi4vYXBwbHlDaGFuZ2VzXCI7XHJcbmltcG9ydCBjaGFuZ2VEZWFkbGluZSBmcm9tIFwiLi9jaGFuZ2VEZWFkbGluZVwiO1xyXG5pbXBvcnQge3Nob3dUYWdlZFRhc2tzLCBjbGVhbkZpbHRlcnN9IGZyb20gXCIuL3Nob3dUYWdlZFRhc2tzXCI7XHJcblxyXG5jb25zdCB0YXNrc0NvbGxlY3Rpb24gPSBbXTsgXHJcbmxldCBjaG9zZW5EZWFkbGluZSA9ICcnOyBcclxubGV0IGNob3NlblRhZ3MgPSBbXTtcclxuXHJcbi8vYWRkIGEgdGFzayBidXR0b24gZnVuY3Rpb25hbGl0eSBcclxuY29uc3QgYWRkQVRhc2tCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRkQVRhc2snKTsgXHJcblxyXG5hZGRBVGFza0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCAoZSkgPT4ge1xyXG4gICAgZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3JnYigzNiwgMTYzLCAyNiknO1xyXG59KVxyXG5hZGRBVGFza0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKGUpID0+IHtcclxuICAgIGUudGFyZ2V0LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZ2IoMjYsIDE1MywgMjYpJ1xyXG59KVxyXG5hZGRBVGFza0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIG9wZW5Nb2RhbChsaWdodFRoZVRhZywgY2hvc2VuVGFncyk7XHJcbn0pXHJcblxyXG4vL21vZHVsZSBvdmVybGF5IGZ1bmN0aW9uYWxpdHlcclxuY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdmVybGF5Jyk7XHJcblxyXG5vdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgY2xvc2VNb2RhbCgpO1xyXG4gICAgY2xvc2VNb2RhbEluZm8oKTtcclxuICAgIGNob3NlbkRlYWRsaW5lID0gJyc7XHJcbiAgICBjaG9zZW5UYWdzID0gW107XHJcbn0pXHJcblxyXG4vL21vZGFsIGlucHV0cyBmdW5jdGlvbmFsaXR5IFxyXG5jb25zdCB0YXNrTmFtZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsVGFza05hbWUnKTsgXHJcbiBcclxudGFza05hbWVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKGUpID0+IHsgXHJcbiAgICBlLnRhcmdldC5zdHlsZS5vdXRsaW5lID0gJ3NvbGlkJztcclxuICAgIGUudGFyZ2V0LnN0eWxlLm91dGxpbmVXaWR0aCA9ICcxcHgnO1xyXG4gICAgZS50YXJnZXQuc3R5bGUub3V0bGluZUNvbG9yID0gJ2dyZXknO1xyXG59KVxyXG5cclxudGFza05hbWVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKGUpID0+IHsgXHJcbiAgICBlLnRhcmdldC5zdHlsZS5vdXRsaW5lID0gJ25vbmUnXHJcbn0pXHJcblxyXG4vL21vZGFsIHdpbmRvdyBkZWFkbGluZXMgZnVuY3Rpb25hbGl0eVxyXG5jb25zdCBkZWFkbGluZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2RlYWRsaW5lJykpO1xyXG5cclxuZGVhZGxpbmVzLmZvckVhY2goZGVhZGxpbmUgPT4geyBcclxuICAgIGRlYWRsaW5lLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIChlKT0+IHtcclxuICAgICAgICBpZihjaG9zZW5EZWFkbGluZSA9PT0gJycpeyBcclxuICAgICAgICAgICAgZS50YXJnZXQuc3R5bGUuY29sb3IgPSAncmdiYSgyNiwgMTUzLCAyNiknO1xyXG4gICAgICAgICB9ICAgIFxyXG4gICAgfSlcclxuICAgIGRlYWRsaW5lLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgKGUpPT4geyBcclxuICAgICAgICBpZihjaG9zZW5EZWFkbGluZSA9PT0gJycpeyBcclxuICAgICAgICAgICAgZS50YXJnZXQuc3R5bGUuY29sb3IgPSAncmdiKDc4LCA3OCwgNzgpJztcclxuICAgICAgICAgfSAgIFxyXG4gICAgfSlcclxufSlcclxuXHJcbiAgICBmb3IobGV0IGk9MDsgaTxkZWFkbGluZXMubGVuZ3RoOyBpKyspeyAgLy8gcmVtZW1iZXJzIHdoaWNoIGRlYWRsaW5lIGhhdmUgeW91IGNob29zZSBcclxuXHJcbiAgICAgZGVhZGxpbmVzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT4ge1xyXG4gICAgICAgICAgICBkZWFkbGluZXMuZm9yRWFjaChkZWFkbGluZSA9PiB7IC8vY2xlYXJzIG90aGVyc1xyXG4gICAgICAgICAgICAgZGVhZGxpbmUuc3R5bGUuY29sb3IgPSAncmdiKDc4LDc4LDc4KSdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgZS50YXJnZXQuc3R5bGUuY29sb3IgPSAncmdiYSgyNiwgMTUzLCAyNiknOyAvL2hpZ2hsaWdodHMgdGhlIGNob3NlblxyXG4gICAgICAgICAgICByZXR1cm4gY2hvc2VuRGVhZGxpbmUgPSBpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4vL3NhdmUgdGFzayBtb2R1bGUgZnVuY3Rpb25hbGl0eSBcclxuY29uc3Qgc2F2ZVRhc2sgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZVRhc2snKTtcclxuXHJcbnNhdmVUYXNrLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgLy9jcmVhdGVzIG5ldyB0YXNrIGFuZCBwdXNoIGl0IHRvIGNvbGxlY3Rpb25cclxuICAgIGNvbnN0IG5vdGVzQXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub3RlcycpO1xyXG4gICAgbGV0IG5ld1Rhc2sgPSBtYWtlVGFzayh0YXNrTmFtZUlucHV0LnZhbHVlLCBjaG9zZW5EZWFkbGluZSwgbm90ZXNBcmVhLnZhbHVlLCBjaG9zZW5UYWdzKTtcclxuICAgIHRhc2tzQ29sbGVjdGlvbi5wdXNoKG5ld1Rhc2spO1xyXG4gICAgc2hvd1Rhc2sobmV3VGFzay5uYW1lLCBuZXdUYXNrLmRlYWRsaW5lLCBuZXdUYXNrLmlkKTtcclxuICAgIC8vY2xlYXJzIG1vZHVsZSB3aW5kb3dcclxuICAgIGNob3NlbkRlYWRsaW5lID0gJyc7IC8vcmV0dXJucyBkZWFkbGluZSB0byB1bmNob3NlbiBcclxuICAgIGNob3NlblRhZ3MgPSBbXTtcclxuICAgIGNsb3NlTW9kYWwoKTsgXHJcbn0pXHJcblxyXG5zYXZlVGFzay5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCAoZSkgPT4ge1xyXG4gICAgZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3JnYigyNiwgMTUzLCAyNiknO1xyXG59KVxyXG5cclxuc2F2ZVRhc2suYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIChlKSA9PiB7XHJcbiAgICBlLnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndHJhbnNwYXJlbnQnO1xyXG59KVxyXG5cclxuLy9kZWFkbGluZVdyYXBwZXIgZnVuY3Rpb25hbGl0eSBcclxuY29uc3QgdG9kb0RlYWRsaW5lcyA9IEFycmF5LmZyb20oZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndG9kb0RlYWRsaW5lJykpO1xyXG50b2RvRGVhZGxpbmVzLmZvckVhY2godG9kb0RlYWRsaW5lID0+IHsgXHJcbiAgICB0b2RvRGVhZGxpbmUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgKGUpID0+IHsgXHJcbiAgICAgICAgaWYoIWUudGFyZ2V0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcpe1xyXG4gICAgICAgICAgICBlLnRhcmdldC5zdHlsZS5ib3JkZXJCb3R0b20gPSAnMS41cHggc29saWQgZ3JleSc7XHJcbiAgICAgICAgICAgIGUudGFyZ2V0LnN0eWxlLmNvbG9yID0gJ2JsYWNrJztcclxuICAgICAgICB9IGVsc2UgeyBcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuYWRkKCdtb3VzZW9uJyk7XHJcbiAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICB0b2RvRGVhZGxpbmUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIChlKSA9PiB7IFxyXG4gICAgICAgIGlmKCFlLnRhcmdldC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKXtcclxuICAgICAgICAgICAgZS50YXJnZXQuc3R5bGUuYm9yZGVyQm90dG9tID0gJ25vbmUnO1xyXG4gICAgICAgICAgICBlLnRhcmdldC5zdHlsZS5jb2xvciA9ICdyZ2IoMTAwLCAxMDAsIDEwMCknO1xyXG4gICAgICAgIH0gZWxzZSB7IFxyXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ21vdXNlb24nKTtcclxuICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIHRvZG9EZWFkbGluZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7IFxyXG4gICAgICAgIGlmKGUudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZy5zdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpeyBcclxuICAgICAgICAgICAgZS50YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICAgICAgfSBlbHNlIHsgXHJcbiAgICAgICAgICAgIGUudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfSlcclxufSlcclxuXHJcbi8vY29tcGxldGVCdXR0b25zIGZ1bmNpb25hbGl0eSAgXHJcbmNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JylcclxuYm9keS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7IFxyXG4gICAgaWYoZS50YXJnZXQubWF0Y2hlcygnLmNvbXBsZXRlQ2lyY2xlJykpIHsgXHJcbiAgICAgICB0cmFuc2ZlclRhc2soZSwgdGFza3NDb2xsZWN0aW9uKTtcclxuICAgICAgIGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB9XHJcbn0pXHJcblxyXG5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIChlKSA9PiB7IFxyXG4gICAgaWYoZS50YXJnZXQubWF0Y2hlcygnLmNvbXBsZXRlQ2lyY2xlJykpIHsgXHJcbiAgICAgICAgZS50YXJnZXQuc3R5bGUuYm9yZGVyID0gJzJweCBzb2xpZCBncmVlbidcclxuICAgIH1cclxufSlcclxuXHJcbmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCAoZSkgPT4geyBcclxuICAgIGlmKGUudGFyZ2V0Lm1hdGNoZXMoJy5jb21wbGV0ZUNpcmNsZScpKSB7IFxyXG4gICAgICAgIGUudGFyZ2V0LnN0eWxlLmJvcmRlciA9ICcxLjk5cHggc29saWQgYmxhY2snXHJcbiAgICB9XHJcbn0pXHJcblxyXG5cclxuLy9jb21wbGV0ZWRUYXNrcyBmdW5jdGlvbmFsaXR5IFxyXG5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIChlKSA9PiB7IFxyXG4gICAgaWYoZS50YXJnZXQubWF0Y2hlcygnLmNvbXBsZXRlZFRhc2snKSkgeyBcclxuICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ21vdXNlb24nKTsgXHJcbiAgICB9XHJcbn0pXHJcblxyXG5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgKGUpID0+IHsgXHJcbiAgICBpZihlLnRhcmdldC5tYXRjaGVzKCcuY29tcGxldGVkVGFzaycpKSB7IFxyXG4gICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgnbW91c2VvbicpOyBcclxuICAgIH1cclxufSlcclxuXHJcbmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSk9PiB7IC8vbWFrZXMgY29tcGxldGVkIHRhc2tzIG9uIGNsaWNrIHJldHVybiBiYWNrIHRvIGl0J3MgcGxhY2VcclxuICAgIGlmKGUudGFyZ2V0Lm1hdGNoZXMoJy5jb21wbGV0ZWRUYXNrJykpIHsgXHJcbiAgICAgICAgc2hvd1Rhc2socmV0dXJuRnJvbUNvbXBsZXRlZChlLCB0YXNrc0NvbGxlY3Rpb24pWzBdLHJldHVybkZyb21Db21wbGV0ZWQoZSwgdGFza3NDb2xsZWN0aW9uKVsxXSxyZXR1cm5Gcm9tQ29tcGxldGVkKGUsIHRhc2tzQ29sbGVjdGlvbilbMl0pO1xyXG4gICAgICAgIGUudGFyZ2V0LnJlbW92ZSgpO1xyXG4gICAgIH1cclxuIH0pXHJcblxyXG4gLy90YWdzIGZ1bmN0aW9uYWxpdHkgXHJcbmNvbnN0IHRhZ3MgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWcnKSk7IC8vYWRkcyB0YWdzIHRvIGNob3NlbiBhcnJheSBhbmQgbGlnaHRzIHVwIGNob3NlblxyXG50YWdzLmZvckVhY2godGFnID0+IHsgIFxyXG4gICAgdGFnLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT4ge1xyXG4gICAgICAgIGNob3NlVGFnKGUsIGNob3NlblRhZ3MpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGNob3NlblRhZ3MpO1xyXG4gICAgICAgIGxpZ2h0VGhlVGFnKGNob3NlblRhZ3MpO1xyXG4gICAgfSlcclxufSlcclxuXHJcbiAvL3Rhc2sgaW5mbyBcclxuIGJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4geyBcclxuICAgICBpZihlLnRhcmdldC5tYXRjaGVzKCcudGFza05hbWUnKSl7XHJcbiAgICAgICAgIGNvbnNvbGUubG9nKGNob3NlblRhZ3MpXHJcbiAgICAgICAgIGNob3NlblRhZ3MgPSBvcGVuTW9kYWxJbmZvKGUsIGxpZ2h0VGhlVGFnLCB0YXNrc0NvbGxlY3Rpb24sIGNob3NlblRhZ3MpO1xyXG4gICAgICAgICBjb25zb2xlLmxvZyhjaG9zZW5UYWdzKVxyXG4gICAgIH0gXHJcbn0pIFxyXG5cclxuLy9hcHBseSBjaGFuZ2VzIGJ1dHRvbiAgXHJcbmNvbnN0IGFwcGx5QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcGx5JylcclxuYXBwbHlCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4geyBcclxuICAgIGFwcGx5Q2hhbmdlcyhlLCBjaG9zZW5UYWdzLCB0YXNrc0NvbGxlY3Rpb24sIGNob3NlbkRlYWRsaW5lLCBzaG93VGFzayk7IFxyXG4gICAgY2xvc2VNb2RhbEluZm8oKTtcclxufSlcclxuXHJcbi8vY2hhbmdlIGRlYWRsaW5lIGZ1bmN0aW9uYWxpdHlcclxuY29uc3QgaW5mb0RlYWRsaW5lID0gQXJyYXkuZnJvbShkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdpbmZvRGVhZGxpbmUnKSk7XHJcblxyXG5pbmZvRGVhZGxpbmUuZm9yRWFjaCggYnV0dG9uID0+IHsgXHJcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSk9PiB7IFxyXG4gICAgICAgIGluZm9EZWFkbGluZS5mb3JFYWNoKGRpdiA9PiB7IFxyXG4gICAgICAgICAgICBkaXYuc3R5bGUuY29sb3IgPSAncmdiKDc4LDc4LDc4KSc7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgY2hvc2VuRGVhZGxpbmUgPSBjaGFuZ2VEZWFkbGluZShlLCBjaG9zZW5EZWFkbGluZSk7XHJcbiAgICB9KVxyXG59KVxyXG5cclxuLy9jYW5jZWwgYnV0dG9uIGZ1bmN0aW9uYWxpdHkgXHJcbmNvbnN0IGNhbmNlbEJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5jZWwnKTsgXHJcbmNhbmNlbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4geyBcclxuICAgIGNsb3NlTW9kYWxJbmZvKCk7XHJcbiAgICBjaG9zZW5EZWFkbGluZSA9ICcnO1xyXG4gICAgY2hvc2VuVGFncyA9IFtdO1xyXG59KVxyXG5cclxuLy9uYXZpZ2F0aW9uIGZ1bmN0aW9uYWxpdHkgXHJcbmNvbnN0IG5hdmlnYXRpb25UYWdzID0gQXJyYXkuZnJvbShkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCduYXZpZ2F0aW9uVGFnJykpIFxyXG5uYXZpZ2F0aW9uVGFncy5mb3JFYWNoKHRhZyA9PiB7XHJcblxyXG4gICAgdGFnLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIChlKSA9PiB7IFxyXG4gICAgICAgIHRhZy5jbGFzc0xpc3QuYWRkKGUudGFyZ2V0LmlkKVxyXG4gICAgfSlcclxuXHJcbiAgICB0YWcuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIChlKSA9PiB7XHJcbiAgICAgICAgaWYoIUFycmF5LmZyb20oZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlKS5pbmNsdWRlcygnYycpKXsgXHJcbiAgICAgICAgICAgIHRhZy5jbGFzc0xpc3QucmVtb3ZlKGUudGFyZ2V0LmlkKVxyXG4gICAgICAgIH1cclxuICAgICAgIFxyXG4gICAgfSlcclxuXHJcbiAgICB0YWcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgXHJcbiAgICAgICAgaWYoQXJyYXkuZnJvbShlLnRhcmdldC5jbGFzc0xpc3QudmFsdWUpLmluY2x1ZGVzKCdjJykpe1xyXG4gICAgICAgICAgICB0YWcuY2xhc3NMaXN0LnJlbW92ZShlLnRhcmdldC5pZClcclxuICAgICAgICAgICAgdGFnLmNsYXNzTGlzdC5yZW1vdmUoJ2Nob3NlbicpXHJcbiAgICAgICAgICAgIGNsZWFuRmlsdGVycyh0YXNrc0NvbGxlY3Rpb24pXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIG5hdmlnYXRpb25UYWdzLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoZWxlbWVudC5pZClcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnY2hvc2VuJylcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0YWcuY2xhc3NMaXN0LmFkZChlLnRhcmdldC5pZClcclxuICAgICAgICAgICAgdGFnLmNsYXNzTGlzdC5hZGQoJ2Nob3NlbicpXHJcbiAgICAgICAgICAgIHNob3dUYWdlZFRhc2tzKGUsIHRhc2tzQ29sbGVjdGlvbikgIFxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcblxyXG5cclxufSkiLCJmdW5jdGlvbiB0cmFuc2ZlclRhc2soZSwgdGFza3NDb2xsZWN0aW9uKSB7IFxyXG4gICAgY29uc3QgdGFza0lkID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QudmFsdWU7XHJcbiAgICBsZXQgdGFzayA9IDA7XHJcbiAgICBcclxuICAgIGZvcihsZXQgaT0wOyBpPHRhc2tzQ29sbGVjdGlvbi5sZW5ndGg7IGkrKyl7IFxyXG4gICAgICAgIGlmKHRhc2tJZCA9PSB0YXNrc0NvbGxlY3Rpb25baV0uaWQpIHsgXHJcbiAgICAgICAgICAgIHRhc2sgPSB0YXNrc0NvbGxlY3Rpb25baV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNvbXBsZXRlZFRhc2tzSG9sZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbXBldGVkVGFza3MnKTsgXHJcbiAgICBjb25zdCBjb21wbGV0ZWRUYXNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGVsJyk7IFxyXG4gICAgY29tcGxldGVkVGFzay5pbm5lclRleHQgPSB0YXNrLm5hbWU7IFxyXG5cclxuICAgIGNvbXBsZXRlZFRhc2suY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkVGFzaycpO1xyXG4gICAgY29tcGxldGVkVGFzay5zZXRBdHRyaWJ1dGUoJ2lkJywgdGFzay5pZClcclxuICAgIGNvbXBsZXRlZFRhc2tzSG9sZGVyLmFwcGVuZENoaWxkKGNvbXBsZXRlZFRhc2spO1xyXG59IFxyXG5cclxuZXhwb3J0IGRlZmF1bHQgdHJhbnNmZXJUYXNrIiwiZnVuY3Rpb24gY2hvc2VUYWcoZSwgY2hvc2VuVGFncyl7XHJcblxyXG4gICAgaWYoY2hvc2VuVGFncy5pbmNsdWRlcyhlLnRhcmdldC5pbm5lclRleHQpKXsgXHJcbiAgICAgICAgZm9yKGxldCBpPTA7IGk8Y2hvc2VuVGFncy5sZW5ndGg7IGkrKyl7IFxyXG4gICAgICAgICAgIGlmKGNob3NlblRhZ3NbaV0gPT0gZS50YXJnZXQuaW5uZXJUZXh0KXsgXHJcbiAgICAgICAgICAgICAgIGNob3NlblRhZ3Muc3BsaWNlKGksIDEpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNob3NlblRhZ3MucHVzaChlLnRhcmdldC5pbm5lclRleHQpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gY2hvc2VuVGFnc1xyXG59IFxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2hvc2VUYWdcclxuIiwiZnVuY3Rpb24gYXBwbHlDaGFuZ2VzKGUsIGNob3NlblRhZ3MsIHRhc2tzQ29sbGVjdGlvbiwgY2hvc2VuRGVhZGxpbmUsIHNob3dUYXNrKSB7IFxyXG5cclxuICAgIC8vdGFncyBjaGFuZ2VcclxuICAgIGNvbnN0IHRhc2tJZCA9IGUudGFyZ2V0LmNsYXNzTGlzdC52YWx1ZTtcclxuICAgIGxldCB0YXNrID0gJyc7XHJcbiAgICBcclxuICAgIGZvcihsZXQgaT0wOyBpPHRhc2tzQ29sbGVjdGlvbi5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgaWYodGFza0lkID09IHRhc2tzQ29sbGVjdGlvbltpXS5pZCl7IFxyXG4gICAgICAgICAgICB0YXNrID0gdGFza3NDb2xsZWN0aW9uW2ldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0YXNrLnRhZ3MgPSBjaG9zZW5UYWdzO1xyXG4gICAgZS50YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSh0YXNrSWQpXHJcblxyXG4gICAgLy9kYXRlIGNoYW5nZVxyXG4gICAgaWYodGFzay5kZWFkbGluZSAhPSBjaG9zZW5EZWFkbGluZSl7IFxyXG4gICAgICAgIHRhc2suZGVhZGxpbmUgPSBjaG9zZW5EZWFkbGluZTtcclxuICAgICAgICBsZXQgb2xkVGFzayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhc2suaWQpXHJcbiAgICAgICAgb2xkVGFzay5wYXJlbnRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIHNob3dUYXNrKHRhc2submFtZSwgdGFzay5kZWFkbGluZSwgdGFzay5pZCk7XHJcbiAgICB9XHJcbiAgICAgXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFwcGx5Q2hhbmdlcyIsImZ1bmN0aW9uIGNoYW5nZURlYWRsaW5lKGUsIGNob3NlbkRlYWRsaW5lKXtcclxuXHJcbiAgICBlLnRhcmdldC5zdHlsZS5jb2xvciA9ICdyZ2IoMjYsIDE1MywgMjYpJztcclxuICAgIFxyXG4gICAgaWYoZS50YXJnZXQuaW5uZXJUZXh0ID09ICdUb2RheScpeyBcclxuICAgICAgICBjaG9zZW5EZWFkbGluZSA9IDA7XHJcbiAgICB9XHJcbiAgICBpZihlLnRhcmdldC5pbm5lclRleHQgPT0gJ1RvbW1vcm93Jyl7IFxyXG4gICAgICAgIGNob3NlbkRlYWRsaW5lID0gMTtcclxuICAgIH1cclxuICAgIGlmKGUudGFyZ2V0LmlubmVyVGV4dCA9PSAnU29tZWRheScpeyBcclxuICAgICAgICBjaG9zZW5EZWFkbGluZSA9IDI7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHJldHVybiBjaG9zZW5EZWFkbGluZVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjaGFuZ2VEZWFkbGluZSIsImZ1bmN0aW9uIHNob3dUYWdlZFRhc2tzKGUsIHRhc2tzQ29sbGVjdGlvbil7IFxyXG4gICAgY29uc3QgY2hvc2VuVGFnID0gZS50YXJnZXQuaW5uZXJUZXh0XHJcbiAgICBjb25zdCB0YXNrcyA9IEFycmF5LmZyb20oZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGFza05hbWUnKSk7XHJcbiAgICBsZXQgbWF0Y2hlZFRhc2tzID0gW107XHJcblxyXG4gICAgZm9yKGxldCBpPTA7IGk8dGFza3NDb2xsZWN0aW9uLmxlbmd0aDsgaSsrKXsgXHJcbiAgICAgICAgZm9yKGxldCBqPTA7IGo8dGFza3NDb2xsZWN0aW9uLmxlbmd0aDsgaisrKXsgXHJcbiAgICAgICAgICAgIGlmKGNob3NlblRhZyA9PSB0YXNrc0NvbGxlY3Rpb25baV0udGFnc1tqXSl7IFxyXG4gICAgICAgICAgICAgICAgbWF0Y2hlZFRhc2tzLnB1c2godGFza3NDb2xsZWN0aW9uW2ldLmlkKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRhc2tzLmZvckVhY2godGFzayA9PiB7XHJcbiAgICAgICAgdGFzay5wYXJlbnRFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgZm9yKGxldCBpPTA7IGk8dGFza3MubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICBpZihtYXRjaGVkVGFza3NbaV0gPT0gdGFzay5pZCl7IFxyXG4gICAgICAgICAgICAgICAgdGFzay5wYXJlbnRFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBjbGVhbkZpbHRlcnModGFza3NDb2xsZWN0aW9uKXsgXHJcbiAgICBjb25zdCB0YXNrcyA9IEFycmF5LmZyb20oZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGFza05hbWUnKSk7XHJcbiAgICB0YXNrcy5mb3JFYWNoKHRhc2sgPT4ge1xyXG4gICAgICAgICAgICB0YXNrLnBhcmVudEVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcclxuICAgIH0pXHJcbn1cclxuXHJcbmV4cG9ydCB7c2hvd1RhZ2VkVGFza3MsIGNsZWFuRmlsdGVyc30iXSwibmFtZXMiOlsiY2xvc2VNb2RhbCIsIm1vZGFsIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm92ZXJsYXkiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ2YWx1ZSIsIm5hbWUiLCJkZWFkbGluZSIsImlkIiwidGFzayIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJhZGQiLCJjb25zb2xlIiwibG9nIiwiY29tcGxldGVDaXJjbGUiLCJ0YXNrTmFtZSIsImlubmVyVGV4dCIsImFwcGVuZENoaWxkIiwiZSIsInRhc2tzQ29sbGVjdGlvbiIsInRhc2tJZCIsInRhcmdldCIsImkiLCJsZW5ndGgiLCJjbG9zZU1vZGFsSW5mbyIsIm1vZGFsSW5mbyIsImFwcGx5QnV0dG9uIiwiY29udGFpbnMiLCJjaG9zZW5UYWdzIiwidGFncyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbmNsdWRlcyIsImNob3NlbkRlYWRsaW5lIiwiYWRkQVRhc2tCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwic3R5bGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJsaWdodFRoZVRhZyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJmb3JFYWNoIiwiY29sb3IiLCJvcGVuTW9kYWwiLCJ0YXNrTmFtZUlucHV0Iiwib3V0bGluZSIsIm91dGxpbmVXaWR0aCIsIm91dGxpbmVDb2xvciIsImRlYWRsaW5lcyIsInNhdmVUYXNrIiwibm90ZXNBcmVhIiwibmV3VGFzayIsIm5vdGVzIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicHVzaCIsInRvZG9EZWFkbGluZSIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJib3JkZXJCb3R0b20iLCJuZXh0RWxlbWVudFNpYmxpbmciLCJkaXNwbGF5IiwiYm9keSIsInF1ZXJ5U2VsZWN0b3IiLCJtYXRjaGVzIiwicGFyZW50RWxlbWVudCIsImNvbXBsZXRlZFRhc2tzSG9sZGVyIiwiY29tcGxldGVkVGFzayIsImJvcmRlciIsInRhZyIsInNwbGljZSIsImluZm9EZWFkbGluZXMiLCJlbGVtZW50Iiwib3Blbk1vZGFsSW5mbyIsInNob3dUYXNrIiwiaW5mb0RlYWRsaW5lIiwiYnV0dG9uIiwiZGl2IiwibmF2aWdhdGlvblRhZ3MiLCJjaG9zZW5UYWciLCJ0YXNrcyIsIm1hdGNoZWRUYXNrcyIsImoiLCJzaG93VGFnZWRUYXNrcyJdLCJzb3VyY2VSb290IjoiIn0=